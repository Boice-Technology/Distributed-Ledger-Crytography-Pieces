<!DOCTYPE html>
<!-- saved from url=(0069)https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc -->
<html lang="en" class="gr__github_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
  <link rel="dns-prefetch" href="https://github.githubassets.com/">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com/">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com/">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-lEwNhIgWxFtdGboTlCciWWGiX2vG3LOojEE671oRJEhnPj6jpmgQTJtpq3O2KBzCcln6RzwfvHlyFaI/oR+RNQ==" rel="stylesheet" href="./Mining_and_Consensus_files/frameworks-849637ecbd4bd65815cc113d80fee2d4.css">
  
    <link crossorigin="anonymous" media="all" integrity="sha512-ZIVQ5xH4xRPgEBzl7RRQebsfNJcuNt4tdhboEnRhGSGhyXVESRTxdb9W439oH0MeqADdj5gxaLCLmHYTlOXqtw==" rel="stylesheet" href="./Mining_and_Consensus_files/github-765e7332c1c58bca34b5cadb2351d4d4.css">
    
    
    
    

  <meta name="viewport" content="width=device-width">
  
  <title>bitcoinbook/ch10.asciidoc at develop Â· bitcoinbook/bitcoinbook</title>
    <meta name="description" content="Mastering Bitcoin 2nd Edition - Programming the Open Blockchain - bitcoinbook/bitcoinbook">
    <link rel="search" type="application/opensearchdescription+xml" href="https://github.com/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    <meta name="twitter:image:src" content="https://avatars2.githubusercontent.com/u/5091621?s=400&amp;v=4"><meta name="twitter:site" content="@github"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="bitcoinbook/bitcoinbook"><meta name="twitter:description" content="Mastering Bitcoin 2nd Edition - Programming the Open Blockchain - bitcoinbook/bitcoinbook">
    <meta property="og:image" content="https://avatars2.githubusercontent.com/u/5091621?s=400&amp;v=4"><meta property="og:site_name" content="GitHub"><meta property="og:type" content="object"><meta property="og:title" content="bitcoinbook/bitcoinbook"><meta property="og:url" content="https://github.com/bitcoinbook/bitcoinbook"><meta property="og:description" content="Mastering Bitcoin 2nd Edition - Programming the Open Blockchain - bitcoinbook/bitcoinbook">

  <link rel="assets" href="https://github.githubassets.com/">
  <link rel="web-socket" href="wss://live.github.com/_sockets/VjI6NDM2NTUxMzAyOmY3YmUzOTVmZDU4YzFhNzUwMTQ4NTQ2MjYyZTkzNzNiOTgwOGY1YWJhZjc0N2FlMGUyNjcwOGE1N2RjNjA1OTU=--852883bc3dcd4509e11d8fb5e1573996ec7725b0">
  <meta name="pjax-timeout" content="1000">
  <link rel="sudo-modal" href="https://github.com/sessions/sudo_modal">
  <meta name="request-id" content="C268:3B13:1B1CEA:276321:5D8F4EA2" data-pjax-transient="">


  

  <meta name="selected-link" value="repo_source" data-pjax-transient="">

      <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
    <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">

  <meta name="octolytics-host" content="collector.githubapp.com"><meta name="octolytics-app-id" content="github"><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event"><meta name="octolytics-dimension-request_id" content="C268:3B13:1B1CEA:276321:5D8F4EA2"><meta name="octolytics-dimension-region_edge" content="ap-south-1"><meta name="octolytics-dimension-region_render" content="iad"><meta name="octolytics-dimension-ga_id" content="935325271.1541954184" class="js-octo-ga-id"><meta name="octolytics-dimension-visitor_id" content="21985677137173129"><meta name="octolytics-actor-id" content="39230975"><meta name="octolytics-actor-login" content="DivyPatel9881"><meta name="octolytics-actor-hash" content="333d6a2d3187fb8dfad2488c729f2e3c1a691345037470fab9aa69054014e5ce">
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true">



    <meta name="google-analytics" content="UA-3769691-2">

  <meta class="js-ga-set" name="userId" content="28564a525bddbe7ce98c4bed09794243">

<meta class="js-ga-set" name="dimension1" content="Logged In">



  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="DivyPatel9881">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="ZDcxOGFhYTlmMzg4Y2JkMmJlOGNlYzI4MTg2NGQwZTkxYzYzYmI4NjUzMDJlYTkwMWJkNzU5M2ZiODg3NDQ0MXx7InJlbW90ZV9hZGRyZXNzIjoiMTAzLjE3LjEwMy4yMDciLCJyZXF1ZXN0X2lkIjoiQzI2ODozQjEzOjFCMUNFQToyNzYzMjE6NUQ4RjRFQTIiLCJ0aW1lc3RhbXAiOjE1Njk2NzI4NjcsImhvc3QiOiJnaXRodWIuY29tIn0=">

    <meta name="enabled-features" content="ACTIONS_V2_ON_MARKETPLACE,MARKETPLACE_FEATURED_BLOG_POSTS,MARKETPLACE_INVOICED_BILLING,MARKETPLACE_SOCIAL_PROOF_CUSTOMERS,MARKETPLACE_TRENDING_SOCIAL_PROOF,MARKETPLACE_RECOMMENDATIONS,MARKETPLACE_PENDING_INSTALLATIONS,NOTIFY_ON_BLOCK,RELATED_ISSUES,GHE_CLOUD_TRIAL">

  <meta name="html-safe-nonce" content="70dee6bc85a4af81b62e97cee1b49327bc2d5f4f">

  <meta http-equiv="x-pjax-version" content="8ae50ecd04a45a3167125c02d6725191">
  

      <link href="https://github.com/bitcoinbook/bitcoinbook/commits/develop.atom" rel="alternate" title="Recent Commits to bitcoinbook:develop" type="application/atom+xml">

  <meta name="go-import" content="github.com/bitcoinbook/bitcoinbook git https://github.com/bitcoinbook/bitcoinbook.git">

  <meta name="octolytics-dimension-user_id" content="5091621"><meta name="octolytics-dimension-user_login" content="bitcoinbook"><meta name="octolytics-dimension-repository_id" content="12044132"><meta name="octolytics-dimension-repository_nwo" content="bitcoinbook/bitcoinbook"><meta name="octolytics-dimension-repository_public" content="true"><meta name="octolytics-dimension-repository_is_fork" content="false"><meta name="octolytics-dimension-repository_network_root_id" content="12044132"><meta name="octolytics-dimension-repository_network_root_nwo" content="bitcoinbook/bitcoinbook"><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false">


    <link rel="canonical" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc" data-pjax-transient="">


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://github.githubassets.com/favicon.ico">

<meta name="theme-color" content="#1e2327">



  <meta name="webauthn-auth-enabled" content="true">

  <meta name="webauthn-registration-enabled" content="true">

  <link rel="manifest" href="https://github.com/manifest.json" crossorigin="use-credentials">

  </head>

  <body class="logged-in env-production page-responsive page-blob" data-gr-c-s-loaded="true">
    

  <div class="position-relative js-header-wrapper ">
    <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#start-of-content" tabindex="1" class="p-3 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    


          <header class="Header js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role="banner">

    <div class="Header-item d-none d-lg-flex">
      <a class="Header-link" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>

    </div>

    <div class="Header-item d-lg-none">
      <button class="Header-link btn-link js-details-target" type="button" aria-label="Toggle navigation" aria-expanded="false">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 12 16" version="1.1" width="18" aria-hidden="true"><path fill-rule="evenodd" d="M11.41 9H.59C0 9 0 8.59 0 8c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zm0-4H.59C0 5 0 4.59 0 4c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM.59 11H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1H.59C0 13 0 12.59 0 12c0-.59 0-1 .59-1z"></path></svg>
      </button>
    </div>

    <div class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden">
        <div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to" role="combobox" aria-owns="jump-to-results" aria-label="Search or jump to" aria-haspopup="listbox" aria-expanded="false">
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --><form class="js-site-search-form" role="search" aria-label="Site" data-scope-type="Repository" data-scope-id="12044132" data-scoped-search-url="/bitcoinbook/bitcoinbook/search" data-unscoped-search-url="/search" action="https://github.com/bitcoinbook/bitcoinbook/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="â">
      <label class="form-control input-sm header-search-wrapper p-0 header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
        <input type="text" class="form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable" data-hotkey="s,/" name="q" value="" placeholder="Search or jump toâ¦" data-unscoped-placeholder="Search or jump toâ¦" data-scoped-placeholder="Search or jump toâ¦" autocapitalize="off" aria-autocomplete="list" aria-controls="jump-to-results" aria-label="Search or jump toâ¦" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations#csrf-token=YOqCxkESS03cmhx24LTqKiAp6HPaO1yDPqo2nSN/tDgBTvB8EBAUtkwRf2sHVdMKK6WS8+5oraqAPZhIOYDE2w==" spellcheck="false" autocomplete="off">
          <input type="hidden" class="js-site-search-type-field" name="type">
            <img src="./Mining_and_Consensus_files/search-key-slash.svg" alt="" class="mr-2 header-search-key-slash">

            <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
              
<ul class="d-none js-jump-to-suggestions-template-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-suggestion" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">âµ</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">âµ</span>
    </div>
  </a>
</li>

</ul>

<ul class="d-none js-jump-to-no-results-template-container">
  <li class="d-flex flex-justify-center flex-items-center f5 d-none js-jump-to-suggestion p-2">
    <span class="text-gray">No suggested jump to results</span>
  </li>
</ul>

<ul id="jump-to-results" role="listbox" class="p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">âµ</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">âµ</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-global-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"></path></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">âµ</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">âµ</span>
    </div>
  </a>
</li>


    <li class="d-flex flex-justify-center flex-items-center p-0 f5 js-jump-to-suggestion">
      <img src="./Mining_and_Consensus_files/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
    </li>
</ul>

            </div>
      </label>
</form>  </div>
</div>


      <nav class="d-flex flex-column flex-lg-row flex-self-stretch flex-lg-self-auto" aria-label="Global">
    <a class="Header-link d-block d-lg-none py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:dashboard:user" aria-label="Dashboard" href="https://github.com/dashboard">
      Dashboard
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g p" data-ga-click="Header, click, Nav menu - item:pulls context:user" aria-label="Pull requests you created" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls" href="https://github.com/pulls">
    Pull requests
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g i" data-ga-click="Header, click, Nav menu - item:issues context:user" aria-label="Issues you created" data-selected-links="/issues /issues/assigned /issues/mentioned /issues" href="https://github.com/issues">
    Issues
</a>
    <div class="mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15">
      <a class="js-selected-navigation-item Header-link" data-ga-click="Header, click, Nav menu - item:marketplace context:user" data-octo-click="marketplace_click" data-octo-dimensions="location:nav_bar" data-selected-links=" /marketplace" href="https://github.com/marketplace">
        Marketplace
</a>      

    </div>

  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="https://github.com/explore">
    Explore
</a>


    <a class="Header-link d-block d-lg-none mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" href="https://github.com/DivyPatel9881">
      <img class="avatar" height="20" width="20" alt="@DivyPatel9881" src="./Mining_and_Consensus_files/39230975">
      DivyPatel9881
</a>
    <!-- '"` --><!-- </textarea></xmp> --><form action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="authenticity_token" value="XFDfNpv3NZk5kvRpQxWRha+fgNK7q6aeok5OA1C0YdbJmKZ7RcpbKMMlEuZPBm3rhUbyBIMWedJjHt7QClmAUg==">
      <button type="submit" class="Header-link mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15 d-lg-none btn-link d-block width-full text-left" data-ga-click="Header, sign out, icon:logout" style="padding-left: 2px;">
        <svg class="octicon octicon-sign-out v-align-middle" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9V7H8V5h4V3l4 3-4 3zm-2 3H6V3L2 1h8v3h1V1c0-.55-.45-1-1-1H1C.45 0 0 .45 0 1v11.38c0 .39.22.73.55.91L6 16.01V13h4c.55 0 1-.45 1-1V8h-1v4z"></path></svg>
        Sign out
      </button>
</form></nav>

    </div>

    <div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative">
      <div class="css-truncate css-truncate-target width-fit position-absolute left-0 right-0 text-center">
              <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
    <a class="Header-link" href="https://github.com/bitcoinbook">bitcoinbook</a>
    /
    <a class="Header-link" href="https://github.com/bitcoinbook/bitcoinbook">bitcoinbook</a>

</div>
    </div>


    <div class="Header-item mr-0 mr-lg-3 flex-order-1 flex-lg-order-none">
      

    <a aria-label="You have no unread notifications" class="Header-link notification-indicator position-relative tooltipped tooltipped-s js-socket-channel js-notification-indicator" data-hotkey="g n" data-ga-click="Header, go to notifications, icon:read" data-channel="notification-changed:39230975" href="https://github.com/notifications">
        <span class="mail-status "></span>
        <svg class="octicon octicon-bell" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z"></path></svg>
</a>
    </div>


    <div class="Header-item position-relative d-none d-lg-flex">
      <details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="Create newâ¦" data-ga-click="Header, create new, icon:add" aria-haspopup="menu" role="button">
    <svg class="octicon octicon-plus" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5v2z"></path></svg> <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw" role="menu">
    
<a role="menuitem" class="dropdown-item" href="https://github.com/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>

<a role="menuitem" class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, create new gist">
  New gist
</a>

  <a role="menuitem" class="dropdown-item" href="https://github.com/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>


  <div role="none" class="dropdown-divider"></div>
  <div class="dropdown-header">
    <span title="bitcoinbook/bitcoinbook">This repository</span>
  </div>
    <a role="menuitem" class="dropdown-item" href="https://github.com/bitcoinbook/bitcoinbook/issues/new" data-ga-click="Header, create new issue" data-skip-pjax="">
      New issue
    </a>


  </details-menu>
</details>

    </div>

    <div class="Header-item position-relative mr-0 d-none d-lg-flex">
      
<details class="details-overlay details-reset">
  <summary class="Header-link" aria-label="View profile and more" data-ga-click="Header, show menu, icon:avatar" aria-haspopup="menu" role="button">
    <img alt="@DivyPatel9881" class="avatar" src="./Mining_and_Consensus_files/39230975(1)" height="20" width="20">
    <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw mt-2" style="width: 180px" role="menu">
    <div class="header-nav-current-user css-truncate"><a role="menuitem" class="no-underline user-profile-link px-3 pt-2 pb-2 mb-n2 mt-n1 d-block" href="https://github.com/DivyPatel9881" data-ga-click="Header, go to profile, text:Signed in as">Signed in as <strong class="css-truncate-target">DivyPatel9881</strong></a></div>
    <div role="none" class="dropdown-divider"></div>

      <div class="pl-3 pr-3 f6 user-status-container js-user-status-context pb-1" data-url="/users/status?compact=1&amp;link_mentions=0&amp;truncate=1">
        
<div class="js-user-status-container
    user-status-compact rounded-1 px-2 py-1 mt-2
    border
  " data-team-hovercards-enabled="">
  <details class="js-user-status-details details-reset details-overlay details-overlay-dark">
    <summary class="btn-link btn-block link-gray no-underline js-toggle-user-status-edit toggle-user-status-edit " role="menuitem" data-hydro-click="{&quot;event_type&quot;:&quot;user_profile.click&quot;,&quot;payload&quot;:{&quot;profile_user_id&quot;:5091621,&quot;target&quot;:&quot;EDIT_USER_STATUS&quot;,&quot;user_id&quot;:39230975,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C268:3B13:1B1CEA:276321:5D8F4EA2&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;}}" data-hydro-click-hmac="88b1f9c04e099dae1bac8ecae46581c504fde022d87d7806b39b11932d9ce2bf">
      <div class="d-flex">
        <div class="f6 lh-condensed user-status-header
          d-inline-block v-align-middle
            user-status-emoji-only-header circle
            pr-2
" style="max-width: 29px">
          <div class="user-status-emoji-container flex-shrink-0 mr-1 mt-1 lh-condensed-ultra v-align-bottom" style="">
            <g-emoji alias="thought_balloon" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4ad.png">ð­</g-emoji>
          </div>
        </div>
        <div class="
          d-inline-block v-align-middle
          
          
           css-truncate css-truncate-target 
           user-status-message-wrapper f6" style="line-height: 20px;">
          <div class="d-inline-block text-gray-dark v-align-text-top text-left">
                <span>I can !!!!!</span>
          </div>
        </div>
      </div>
    </summary>
    <details-dialog class="details-dialog rounded-1 anim-fade-in fast Box Box--overlay" role="dialog" tabindex="-1" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="position-relative flex-auto js-user-status-form" action="https://github.com/users/status?compact=1&amp;link_mentions=0&amp;truncate=1" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="_method" value="put"><input type="hidden" name="authenticity_token" value="kgar7vA31w5PHGhjV+ycOkmdYzcZHmwgslhZvZB7XPWETW6qamh5K1yWW0a6i/3aA5IQNhOf3kzTirZB/UzVaw==">
        <div class="Box-header bg-gray border-bottom p-3">
          <button class="Box-btn-octicon js-toggle-user-status-edit btn-octicon float-right" type="reset" aria-label="Close dialog" data-close-dialog="">
            <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
          </button>
          <h3 class="Box-title f5 text-bold text-gray-dark">Edit status</h3>
        </div>
        <input type="hidden" name="emoji" class="js-user-status-emoji-field" value="">
        <input type="hidden" name="organization_id" class="js-user-status-org-id-field" value="">
        <div class="px-3 py-2 text-gray-dark">
          <div class="js-characters-remaining-container position-relative mt-2">
            <div class="input-group d-table form-group my-0 js-user-status-form-group">
              <span class="input-group-button d-table-cell v-align-middle" style="width: 1%">
                <button type="button" aria-label="Choose an emoji" class="btn-outline btn js-toggle-user-status-emoji-picker btn-open-emoji-picker p-0">
                  <span class="js-user-status-original-emoji" hidden=""></span>
                  <span class="js-user-status-custom-emoji"></span>
                  <span class="js-user-status-no-emoji-icon">
                    <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"></path></svg>
                  </span>
                </button>
              </span>
              <text-expander keys=": @" data-mention-url="/autocomplete/user-suggestions" data-emoji-url="/autocomplete/emoji">
                <input type="text" autocomplete="off" data-no-org-url="/autocomplete/user-suggestions" data-org-url="/suggestions?mention_suggester=1" data-maxlength="80" class="d-table-cell width-full form-control js-user-status-message-field js-characters-remaining-field" placeholder="What&#39;s happening?" name="message" value="I can !!!!!" aria-label="What is your current status?">
              </text-expander>
              <div class="error">Could not update your status, please try again.</div>
            </div>
            <div style="margin-left: 53px" class="my-1 text-small label-characters-remaining js-characters-remaining" data-suffix="remaining" hidden="">
              80 remaining
            </div>
          </div>
          <include-fragment class="js-user-status-emoji-picker" data-url="/users/status/emoji"></include-fragment>
          <div class="overflow-auto ml-n3 mr-n3 px-3 border-bottom" style="max-height: 33vh">
            <div class="user-status-suggestions js-user-status-suggestions collapsed overflow-hidden">
              <h4 class="f6 text-normal my-3">Suggestions:</h4>
              <div class="mx-3 mt-2 clearfix">
                  <div class="float-left col-6">
                      <button type="button" value=":palm_tree:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="palm_tree" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f334.png">ð´</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          On vacation
                        </div>
                      </button>
                      <button type="button" value=":face_with_thermometer:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="face_with_thermometer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f912.png">ð¤</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Out sick
                        </div>
                      </button>
                  </div>
                  <div class="float-left col-6">
                      <button type="button" value=":house:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="house" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3e0.png">ð </g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Working from home
                        </div>
                      </button>
                      <button type="button" value=":dart:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="dart" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3af.png">ð¯</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Focusing
                        </div>
                      </button>
                  </div>
              </div>
            </div>
            <div class="user-status-limited-availability-container">
              <div class="form-checkbox my-0">
                <input type="checkbox" name="limited_availability" value="1" class="js-user-status-limited-availability-checkbox" data-default-message="I may be slow to respond." aria-describedby="limited-availability-help-text-truncate-true-compact-true" id="limited-availability-truncate-true-compact-true">
                <label class="d-block f5 text-gray-dark mb-1" for="limited-availability-truncate-true-compact-true">
                  Busy
                </label>
                <p class="note" id="limited-availability-help-text-truncate-true-compact-true">
                  When others mention you, assign you, or request your review,
                  GitHub will let them know that you have limited availability.
                </p>
              </div>
            </div>
          </div>
            

<div class="d-inline-block f5 mr-2 pt-3 pb-2">
  <div class="d-inline-block mr-1">
    Clear status
  </div>

  <details class="js-user-status-expire-drop-down f6 dropdown details-reset details-overlay d-inline-block mr-2">
    <summary class="f5 btn-link link-gray-dark border px-2 py-1 rounded-1" aria-haspopup="true">
      <div class="js-user-status-expiration-interval-selected d-inline-block v-align-baseline">
        Never
      </div>
      <div class="dropdown-caret"></div>
    </summary>

    <ul class="dropdown-menu dropdown-menu-se pl-0 overflow-auto" style="width: 220px; max-height: 15.5em">
      <li>
        <button type="button" class="btn-link dropdown-item js-user-status-expire-button ws-normal" title="Never">
          <span class="d-inline-block text-bold mb-1">Never</span>
          <div class="f6 lh-condensed">Keep this status until you clear your status or edit your status.</div>
        </button>
      </li>
      <li class="dropdown-divider" role="none"></li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 30 minutes" value="2019-09-28T18:14:27+05:30">
            in 30 minutes
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 1 hour" value="2019-09-28T18:44:27+05:30">
            in 1 hour
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 4 hours" value="2019-09-28T21:44:27+05:30">
            in 4 hours
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="today" value="2019-09-28T23:59:59+05:30">
            today
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="this week" value="2019-09-29T23:59:59+05:30">
            this week
          </button>
        </li>
    </ul>
  </details>
  <input class="js-user-status-expiration-date-input" type="hidden" name="expires_at" value="">
</div>

          <include-fragment class="js-user-status-org-picker" data-url="/users/status/organizations"></include-fragment>
        </div>
        <div class="d-flex flex-items-center flex-justify-between p-3 border-top">
          <button type="submit" class="width-full btn btn-primary mr-2 js-user-status-submit">
            Set status
          </button>
          <button type="button" class="width-full js-clear-user-status-button btn ml-2 js-user-status-exists">
            Clear status
          </button>
        </div>
</form>    </details-dialog>
  </details>
</div>

      </div>
      <div role="none" class="dropdown-divider"></div>


    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881" data-ga-click="Header, go to profile, text:your profile">Your profile</a>


    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881?tab=repositories" data-ga-click="Header, go to repositories, text:your repositories">Your repositories</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881?tab=projects" data-ga-click="Header, go to projects, text:your projects">Your projects</a>

    <a role="menuitem" class="dropdown-item" href="https://github.com/DivyPatel9881?tab=stars" data-ga-click="Header, go to starred repos, text:your stars">Your stars</a>
      <a role="menuitem" class="dropdown-item" href="https://gist.github.com/mine" data-ga-click="Header, your gists, text:your gists">Your gists</a>


    <div role="none" class="dropdown-divider"></div>
    <a role="menuitem" class="dropdown-item" href="https://help.github.com/" data-ga-click="Header, go to help, text:help">Help</a>
    <a role="menuitem" class="dropdown-item" href="https://github.com/settings/profile" data-ga-click="Header, go to settings, icon:settings">Settings</a>
    <!-- '"` --><!-- </textarea></xmp> --><form class="logout-form" action="https://github.com/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="authenticity_token" value="3VYSIGkEySHI9bA2iNj3Vh9pI+hMNHnDEyIQzemxHr1InmtttzmnkDJCVrmEyws4NbBRPnSJpo/ScoAes1z/OQ==">
      
      <button type="submit" class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout" role="menuitem">
        Sign out
      </button>
</form>  </details-menu>
</details>

    </div>

  </header>

      

  </div>

  <div id="start-of-content" class="show-on-focus"></div>


    <div id="js-flash-container">

</div>



  <div class="application-main " data-commit-hovercards-enabled="">
        <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main>
      


  



  








  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4 ">
    <div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block">

      <ul class="pagehead-actions">




  <li>
    
    <!-- '"` --><!-- </textarea></xmp> --><form data-remote="true" class="clearfix js-social-form js-social-container" action="https://github.com/notifications/subscribe" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="authenticity_token" value="MwlLZFGE5qeyv2NWQ/rc3siIBmVavIaJpIFWXbwrwbsf4UrtIMgoRFTjFA2WRPFgUcSAUokAck81IqzalsMwJw==">      <input type="hidden" name="repository_id" value="12044132">

      <details class="details-reset details-overlay select-menu float-left">
        <summary class="select-menu-button float-left btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;WATCH_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C268:3B13:1B1CEA:276321:5D8F4EA2&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="38d28fdd04de1d133a8132036d4deff2931ed4d6a4f46c26a30900ae358c33a2" data-ga-click="Repository, click Watch settings, action:blob#show" aria-haspopup="menu" role="button">          <span data-menu-button="">
              <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
              Watch
          </span>
</summary>        <details-menu class="select-menu-modal position-absolute mt-5" style="z-index: 99;" role="menu">
          <div class="select-menu-header">
            <span class="select-menu-title">Notifications</span>
          </div>
          <div class="select-menu-list">
            <button type="submit" name="do" value="included" class="select-menu-item width-full" aria-checked="true" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Not watching</span>
                <span class="description">Be notified only when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Watch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="release_only" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Releases only</span>
                <span class="description">Be notified of new releases, and when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch releases
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="subscribed" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Watching</span>
                <span class="description">Be notified of all conversations.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"></path></svg>
                  Unwatch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="ignore" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"></path></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Ignoring</span>
                <span class="description">Never be notified.</span>
                <span class="hidden-select-button-text" data-menu-button-contents="">
                  <svg class="octicon octicon-mute v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"></path></svg>
                  Stop ignoring
                </span>
              </div>
            </button>
          </div>
        </details-menu>
      </details>
        <a class="social-count js-social-count" href="https://github.com/bitcoinbook/bitcoinbook/watchers" aria-label="992 users are watching this repository">
          992
        </a>
</form>
  </li>

  <li>
      <div class="js-toggler-container js-social-container starring-container ">
    <!-- '"` --><!-- </textarea></xmp> --><form class="starred js-social-form" action="https://github.com/bitcoinbook/bitcoinbook/unstar" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="authenticity_token" value="ZJUU8wBqeFSLzuo+HOe0WC2DcdtSRXMFyFpWj6v4EJzbmCzQ6Unl7fkMblw6lv3AGc3n0pdqXc76l8CojAM9Lg==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Unstar bitcoinbook/bitcoinbook" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;UNSTAR_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C268:3B13:1B1CEA:276321:5D8F4EA2&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="da475c53cd53dd1339bad0d583d40a698e943a1ecc1577423acdedd80d544435" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Unstar
</button>        <a class="social-count js-social-count" href="https://github.com/bitcoinbook/bitcoinbook/stargazers" aria-label="12336 users starred this repository">
           12,336
        </a>
</form>
    <!-- '"` --><!-- </textarea></xmp> --><form class="unstarred js-social-form" action="https://github.com/bitcoinbook/bitcoinbook/star" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="authenticity_token" value="+PMJq0hfx3/6jqPwL4aYX2H8q3ZbMtF9uDTeOR3bRwL82I7haYc+GnAPQRGqx3mkg3cGXSUSnb6JLf99eHapKg==">
      <input type="hidden" name="context" value="repository">
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Star bitcoinbook/bitcoinbook" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;STAR_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C268:3B13:1B1CEA:276321:5D8F4EA2&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="f2498bd281232c9dc5e88c8b75ee0bd4ecca503dba5284d9af8b93dfc827191f" data-ga-click="Repository, click star button, action:blob#show; text:Star">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"></path></svg>
        Star
</button>        <a class="social-count js-social-count" href="https://github.com/bitcoinbook/bitcoinbook/stargazers" aria-label="12336 users starred this repository">
          12,336
        </a>
</form>  </div>

  </li>

  <li>
          <details class="details-reset details-overlay details-overlay-dark d-inline-block float-left">
            <summary class="btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FORK_BUTTON&quot;,&quot;repository_id&quot;:12044132,&quot;client_id&quot;:&quot;5118939.1541954185&quot;,&quot;originating_request_id&quot;:&quot;C268:3B13:1B1CEA:276321:5D8F4EA2&quot;,&quot;originating_url&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc&quot;,&quot;referrer&quot;:&quot;https://github.com/bitcoinbook/bitcoinbook&quot;,&quot;user_id&quot;:39230975}}" data-hydro-click-hmac="7a9345d5edfca0669e062308b86e6c72a648873c230de2642cf1004c2eecb816" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork" title="Fork your own copy of bitcoinbook/bitcoinbook to your account" role="button">              <svg class="octicon octicon-repo-forked v-align-text-bottom" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
              Fork
</summary>            <details-dialog class="anim-fade-in fast Box Box--overlay d-flex flex-column" src="/bitcoinbook/bitcoinbook/fork?fragment=1" preload="" role="dialog" aria-modal="true">
              <div class="Box-header">
                <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog="">
                  <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
                </button>
                <h3 class="Box-title">Fork bitcoinbook</h3>
              </div>
              <div class="overflow-auto text-center">
                <include-fragment>
                  <div class="octocat-spinner my-3" aria-label="Loading..."></div>
                  <p class="f5 text-gray">If this dialog fails to load, you can visit <a href="https://github.com/bitcoinbook/bitcoinbook/fork">the fork page</a> directly.</p>
                </include-fragment>
              </div>
            </details-dialog>
          </details>

    <a href="https://github.com/bitcoinbook/bitcoinbook/network/members" class="social-count" aria-label="3585 users forked this repository">
      3,585
    </a>
  </li>
</ul>

      <h1 class="public ">
    <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"></path></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" data-hovercard-type="organization" data-hovercard-url="/orgs/bitcoinbook/hovercard" href="https://github.com/bitcoinbook">bitcoinbook</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="https://github.com/bitcoinbook/bitcoinbook">bitcoinbook</a></strong>
  

</h1>

    </div>
    
<nav class="hx_reponav reponav js-repo-nav js-sidenav-container-pjax container-lg p-responsive d-none d-lg-block" itemscope="" itemtype="http://schema.org/BreadcrumbList" aria-label="Repository" data-pjax="#js-repo-pjax-container">

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /bitcoinbook/bitcoinbook" href="https://github.com/bitcoinbook/bitcoinbook">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"></path></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /bitcoinbook/bitcoinbook/issues" href="https://github.com/bitcoinbook/bitcoinbook/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">66</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /bitcoinbook/bitcoinbook/pulls" href="https://github.com/bitcoinbook/bitcoinbook/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"></path></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">24</span>
      <meta itemprop="position" content="3">
</a>  </span>


    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /bitcoinbook/bitcoinbook/projects" href="https://github.com/bitcoinbook/bitcoinbook/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"></path></svg>
      Projects
      <span class="Counter">0</span>
</a>


    <a data-skip-pjax="true" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy code_scanning /bitcoinbook/bitcoinbook/security/advisories" href="https://github.com/bitcoinbook/bitcoinbook/security/advisories">
      <svg class="octicon octicon-shield" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 2l7-2 7 2v6.02C14 12.69 8.69 16 7 16c-1.69 0-7-3.31-7-7.98V2zm1 .75L7 1l6 1.75v5.268C13 12.104 8.449 15 7 15c-1.449 0-6-2.896-6-6.982V2.75zm1 .75L7 2v12c-1.207 0-5-2.482-5-5.985V3.5z"></path></svg>
      Security
</a>
    <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse people /bitcoinbook/bitcoinbook/pulse" href="https://github.com/bitcoinbook/bitcoinbook/pulse">
      <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"></path></svg>
      Insights
</a>

</nav>

  <div class="reponav-wrapper reponav-small d-lg-none">
  <nav class="reponav js-reponav text-center no-wrap" itemscope="" itemtype="http://schema.org/BreadcrumbList">

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a class="js-selected-navigation-item selected reponav-item" itemprop="url" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /bitcoinbook/bitcoinbook" href="https://github.com/bitcoinbook/bitcoinbook">
        <span itemprop="name">Code</span>
        <meta itemprop="position" content="1">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /bitcoinbook/bitcoinbook/issues" href="https://github.com/bitcoinbook/bitcoinbook/issues">
          <span itemprop="name">Issues</span>
          <span class="Counter">66</span>
          <meta itemprop="position" content="2">
</a>      </span>

    <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /bitcoinbook/bitcoinbook/pulls" href="https://github.com/bitcoinbook/bitcoinbook/pulls">
        <span itemprop="name">Pull requests</span>
        <span class="Counter">24</span>
        <meta itemprop="position" content="3">
</a>    </span>

      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /bitcoinbook/bitcoinbook/projects" href="https://github.com/bitcoinbook/bitcoinbook/projects">
          <span itemprop="name">Projects</span>
          <span class="Counter">0</span>
          <meta itemprop="position" content="4">
</a>      </span>


      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy code_scanning /bitcoinbook/bitcoinbook/security/advisories" href="https://github.com/bitcoinbook/bitcoinbook/security/advisories">
        <span itemprop="name">Security</span>
        <meta itemprop="position" content="6">
</a>
      <a class="js-selected-navigation-item reponav-item" data-selected-links="pulse /bitcoinbook/bitcoinbook/pulse" href="https://github.com/bitcoinbook/bitcoinbook/pulse">
        Pulse
</a>
      <span itemscope="" itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="community /bitcoinbook/bitcoinbook/community" href="https://github.com/bitcoinbook/bitcoinbook/community">
          Community
</a>      </span>

  </nav>
</div>


  </div>
<div class="container-lg clearfix new-discussion-timeline experiment-repo-nav  p-responsive">
  <div class="repository-content ">

    
    


  


    <a class="d-none js-permalink-shortcut" data-hotkey="y" href="https://github.com/bitcoinbook/bitcoinbook/blob/38e5bd84a6b15025bc84be9073f717db9bb81ee9/ch10.asciidoc">Permalink</a>

    <!-- blob contrib key: blob_contributors:v21:113122314aaf35c1e007afd9e6b9a25b -->
      

    <div class="d-flex flex-items-start flex-shrink-0 pb-3 flex-column flex-md-row">
      <span class="d-flex flex-justify-between width-full width-md-auto">
        
<details class="details-reset details-overlay select-menu branch-select-menu  hx_rsm" id="branch-select-menu">
  <summary class="btn btn-sm select-menu-button css-truncate" data-hotkey="w" title="Switch branches or tags" aria-haspopup="menu" role="button">
    <i>Branch:</i>
    <span class="css-truncate-target" data-menu-button="">develop</span>
  </summary>

  <details-menu class="select-menu-modal hx_rsm-modal position-absolute" style="z-index: 99;" src="/bitcoinbook/bitcoinbook/ref-list/develop/ch10.asciidoc?source_action=show&amp;source_controller=blob" preload="" role="menu">
    <include-fragment class="select-menu-loading-overlay anim-pulse">
      <svg height="32" class="octicon octicon-octoface" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M14.7 5.34c.13-.32.55-1.59-.13-3.31 0 0-1.05-.33-3.44 1.3-1-.28-2.07-.32-3.13-.32s-2.13.04-3.13.32c-2.39-1.64-3.44-1.3-3.44-1.3-.68 1.72-.26 2.99-.13 3.31C.49 6.21 0 7.33 0 8.69 0 13.84 3.33 15 7.98 15S16 13.84 16 8.69c0-1.36-.49-2.48-1.3-3.35zM8 14.02c-3.3 0-5.98-.15-5.98-3.35 0-.76.38-1.48 1.02-2.07 1.07-.98 2.9-.46 4.96-.46 2.07 0 3.88-.52 4.96.46.65.59 1.02 1.3 1.02 2.07 0 3.19-2.68 3.35-5.98 3.35zM5.49 9.01c-.66 0-1.2.8-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.54-1.78-1.2-1.78zm5.02 0c-.66 0-1.2.79-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.53-1.78-1.2-1.78z"></path></svg>
    </include-fragment>
  </details-menu>
</details>

        <div class="BtnGroup flex-shrink-0 d-md-none">
          <a href="https://github.com/bitcoinbook/bitcoinbook/find/develop" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
            Find file
          </a>
          <clipboard-copy value="ch10.asciidoc" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
            Copy path
          </clipboard-copy>
        </div>
      </span>
      <h2 id="blob-path" class="breadcrumb flex-auto min-width-0 text-normal flex-md-self-center ml-md-2 mr-md-3 my-2 my-md-0">
        <span class="js-repo-root text-bold"><span class="js-path-segment"><a data-pjax="true" href="https://github.com/bitcoinbook/bitcoinbook"><span>bitcoinbook</span></a></span></span><span class="separator">/</span><strong class="final-path">ch10.asciidoc</strong>
      </h2>

      <div class="BtnGroup flex-shrink-0 d-none d-md-inline-block">
        <a href="https://github.com/bitcoinbook/bitcoinbook/find/develop" class="js-pjax-capture-input btn btn-sm BtnGroup-item" data-pjax="" data-hotkey="t">
          Find file
        </a>
        <clipboard-copy value="ch10.asciidoc" class="btn btn-sm BtnGroup-item" tabindex="0" role="button">
          Copy path
        </clipboard-copy>
      </div>
    </div>



    
  <div class="Box Box--condensed d-flex flex-column flex-shrink-0">
      <div class="Box-body d-flex flex-justify-between bg-blue-light flex-column flex-md-row flex-items-start flex-md-items-center">
        <span class="pr-md-4 f6">
          <a rel="contributor" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1130872" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/wbnns"><img class="avatar" src="./Mining_and_Consensus_files/1130872" width="20" height="20" alt="@wbnns"></a>
          <a class="text-bold link-gray-dark lh-default v-align-middle" rel="contributor" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1130872" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/wbnns">wbnns</a>
            <span class="lh-default v-align-middle">
              <a data-pjax="true" title="Merge pull request #555 from oboukli/chapter-10-updates

Fix inconsistent date format" class="link-gray" href="https://github.com/bitcoinbook/bitcoinbook/commit/bfbc62a1a6a3eca9335d21a58002361a125a59c3">Merge pull request</a> <a class="issue-link js-issue-link" data-error-text="Failed to load issue title" data-id="317833741" data-permission-text="Issue title is private" data-url="https://github.com/bitcoinbook/bitcoinbook/issues/555" data-hovercard-type="pull_request" data-hovercard-url="/bitcoinbook/bitcoinbook/pull/555/hovercard" href="https://github.com/bitcoinbook/bitcoinbook/pull/555">#555</a> <a data-pjax="true" title="Merge pull request #555 from oboukli/chapter-10-updates

Fix inconsistent date format" class="link-gray" href="https://github.com/bitcoinbook/bitcoinbook/commit/bfbc62a1a6a3eca9335d21a58002361a125a59c3">from oboukli/chapter-10-updates</a>
            </span>
        </span>
        <span class="d-inline-block flex-shrink-0 v-align-bottom f6 mt-2 mt-md-0">
          <a class="pr-2 text-mono link-gray" href="https://github.com/bitcoinbook/bitcoinbook/commit/bfbc62a1a6a3eca9335d21a58002361a125a59c3" data-pjax="">bfbc62a</a>
          <relative-time datetime="2019-06-19T20:51:56Z" title="Jun 20, 2019, 2:21 AM GMT+5:30">on Jun 20</relative-time>
        </span>
      </div>

    <div class="Box-body d-flex flex-items-center flex-auto f6 border-bottom-0 flex-wrap">
      <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2" id="blob_contributors_box">
        <summary class="btn-link" role="button">
          <span><strong>16</strong> contributors</span>
        </summary>
        <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast" aria-label="Users who have contributed to this file" src="/bitcoinbook/bitcoinbook/contributors/develop/ch10.asciidoc/list" preload="" role="dialog" aria-modal="true">
          <div class="Box-header">
            <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog="">
              <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
            </button>
            <h3 class="Box-title">
              Users who have contributed to this file
            </h3>
          </div>
          <include-fragment class="octocat-spinner my-3" aria-label="Loading..."></include-fragment>
        </details-dialog>
      </details>
        <span class="">
    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=5178634" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=IndexPro">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/5178634" width="20" height="20" alt="@IndexPro"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=13317719" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=nadamsoreilly">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/13317719" width="20" height="20" alt="@nadamsoreilly"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1181915" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=aantonop">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/1181915" width="20" height="20" alt="@aantonop"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1178372" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=kristenORM">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/1178372" width="20" height="20" alt="@kristenORM"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1180731" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=myarbrough">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/1180731" width="20" height="20" alt="@myarbrough"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=1130872" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=wbnns">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/1130872" width="20" height="20" alt="@wbnns"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=91535" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=theStack">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/91535" width="20" height="20" alt="@theStack"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=170670" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=philippgille">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/170670" width="20" height="20" alt="@philippgille"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=2633903" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=mjones-wordco">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/2633903" width="20" height="20" alt="@mjones-wordco"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=7134319" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=hackermatthew">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/7134319" width="20" height="20" alt="@hackermatthew"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=25371667" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=Rfurse">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/25371667" width="20" height="20" alt="@Rfurse"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=24260969" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=pphili">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/24260969" width="20" height="20" alt="@pphili"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=25386049" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=oboukli">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/25386049" width="20" height="20" alt="@oboukli"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=6399679" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=MarcoFalke">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/6399679" width="20" height="20" alt="@MarcoFalke"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=8949706" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=dimitris-t">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/8949706" width="20" height="20" alt="@dimitris-t"> 
</a>    <a class="avatar-link" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=702021" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc?author=Quuxplusone">
      <img class="avatar mr-1" src="./Mining_and_Consensus_files/702021" width="20" height="20" alt="@Quuxplusone"> 
</a>
</span>

    </div>
  </div>





    <div class="Box mt-3 position-relative">
      
<div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center">

  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
      1123 lines (763 sloc)
      <span class="file-info-divider"></span>
    128 KB
  </div>

  <div class="d-flex py-1 py-md-0 flex-auto flex-order-1 flex-md-order-2 flex-sm-grow-0 flex-justify-between">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="https://github.com/bitcoinbook/bitcoinbook/raw/develop/ch10.asciidoc">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="https://github.com/bitcoinbook/bitcoinbook/blame/develop/ch10.asciidoc">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="https://github.com/bitcoinbook/bitcoinbook/commits/develop/ch10.asciidoc">History</a>
    </div>


    <div>
            <a class="btn-octicon tooltipped tooltipped-nw hide-sm" href="x-github-client://openRepo/https://github.com/bitcoinbook/bitcoinbook?branch=develop&amp;filepath=ch10.asciidoc" aria-label="Open this file in GitHub Desktop" data-ga-click="Repository, open with desktop, type:windows">
                <svg class="octicon octicon-device-desktop" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z"></path></svg>
            </a>

            <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form js-update-url-with-hash" action="https://github.com/bitcoinbook/bitcoinbook/edit/develop/ch10.asciidoc" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="authenticity_token" value="OjHcf4Baan03znGPKKd5IDjuXYPlEjrAAvpHabT8bjtP1g6M2dlMIBly1JMkMKM5fnssHd/wxsK72NQDvStMJg==">
              <button class="btn-octicon tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with="">
                <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path></svg>
              </button>
</form>
          <!-- '"` --><!-- </textarea></xmp> --><form class="inline-form" action="https://github.com/bitcoinbook/bitcoinbook/delete/develop/ch10.asciidoc" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="â"><input type="hidden" name="authenticity_token" value="wiVhhNJvPNE0yljiUlPHe6nh+R2cqyMTMi9EI9RJaCwEtbM8PAj7YIhvU4eJMoB+GCs45zb4XwVEobGUxPqEUg==">
            <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit" aria-label="Fork this project and delete the file" data-disable-with="">
              <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"></path></svg>
            </button>
</form>    </div>
  </div>
</div>




      
  <div id="readme" class="Box-body readme blob instapaper_body js-code-block-container">
    <article class="markdown-body entry-content p-3 p-md-6" itemprop="text"><div>
<h2 id="user-content-mining"><a id="user-content-mining-and-consensus" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#mining-and-consensus"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mining and Consensus</h2>
<div>
<div>
<h3 id="user-content-introduction"><a id="user-content-introduction" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#introduction"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h3>
<div>
<p>The word "mining" is somewhat misleading. By evoking the extraction of precious metals, it focuses our attention on the reward for mining, the new bitcoin created in each block. Although mining is incentivized by this reward, the primary purpose of mining is not the reward or the generation of new coins. If you view mining only as the process by which coins are created, you are mistaking the means (incentives) as the goal of the process. Mining is the mechanism that underpins the decentralized clearinghouse, by which transactions are validated and cleared. Mining is the invention that makes bitcoin special, a decentralized security mechanism that is the basis for P2P digital cash.</p>
</div>
<div>
<p>Mining <em>secures the bitcoin system</em> and enables the emergence of network-wide <em>consensus without a central authority</em>. The reward of newly minted coins and transaction fees is an incentive scheme that aligns the actions of miners with the security of the network, while simultaneously implementing the monetary supply.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>The purpose of mining is not the creation of new bitcoin. Thatâs the incentive system. Mining is the mechanism by which bitcoinâs <em>security</em> is <em>decentralized</em>.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>Miners validate new transactions and record them on the global ledger. A new block, containing transactions that occurred since the last block, is "mined" every 10 minutes on average, thereby adding those transactions to the blockchain. Transactions that become part of a block and added to the blockchain are considered "confirmed," which allows the new owners of bitcoin to spend the bitcoin they received in those transactions.</p>
</div>
<div>
<p>Miners receive two types of rewards in return for the security provided by mining: new coins created with each new block, and transaction fees from all the transactions included in the block. To earn this reward, miners compete to solve a difficult mathematical problem based on a cryptographic hash algorithm. The solution to the problem, called the Proof-of-Work, is included in the new block and acts as proof that the miner expended significant computing effort. The competition to solve the Proof-of-Work algorithm to earn the reward and the right to record transactions on the blockchain is the basis for bitcoinâs security model.</p>
</div>
<div>
<p>The process is called mining because the reward (new coin generation) is designed to simulate diminishing returns, just like mining for precious metals. Bitcoinâs money supply is created through mining, similar to how a central bank issues new money by printing bank notes. The maximum amount of newly created bitcoin a miner can add to a block decreases approximately every four years (or precisely every 210,000 blocks). It started at 50 bitcoin per block in January of 2009 and halved to 25 bitcoin per block in November of 2012. It halved again to 12.5 bitcoin in July 2016. Based on this formula, bitcoin mining rewards decrease exponentially until approximately the year 2140, when all bitcoin (20.99999998 million) will have been issued. After 2140, no new bitcoin will be issued.</p>
</div>
<div>
<p>Bitcoin miners also earn fees from transactions. Every transaction may include a transaction fee, in the form of a surplus of bitcoin between the transactionâs inputs and outputs. The winning bitcoin miner gets to "keep the change" on the transactions included in the winning block. Today, the fees represent 0.5% or less of a bitcoin minerâs income, the vast majority coming from the newly minted bitcoin. However, as the reward decreases over time and the number of transactions per block increases, a greater proportion of bitcoin mining earnings will come from fees. Gradually, the mining reward will be dominated by transaction fees, which will form the primary incentive for miners. After 2140, the amount of new bitcoin in each block drops to zero and bitcoin mining will be incentivized only by transaction fees.</p>
</div>
<div>
<p>In this chapter, we will first examine mining as a monetary supply mechanism and then look at the most important function of mining: the decentralized consensus mechanism that underpins bitcoinâs security.</p>
</div>
<div>
<p>To understand mining and consensus, we will follow Aliceâs transaction as it is received and added to a block by Jingâs mining equipment. Then we will follow the block as it is mined, added to the blockchain, and accepted by the bitcoin network through the process of emergent consensus.</p>
</div>
<div>
<h4 id="user-content-bitcoin-economics-and-currency-creation"><a id="user-content-bitcoin-economics-and-currency-creation" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#bitcoin-economics-and-currency-creation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bitcoin Economics and Currency Creation</h4>
<div>
<p>Bitcoin are "minted" during the creation of each block at a fixed and diminishing rate. Each block, generated on average every 10 minutes, contains entirely new bitcoin, created from nothing. Every 210,000 blocks, or approximately every four years, the currency issuance rate is decreased by 50%. For the first four years of operation of the network, each block contained 50 new bitcoin.</p>
</div>
<div>
<p>In November 2012, the new bitcoin issuance rate was decreased to 25 bitcoin per block. In July of 2016 it was decreased again to 12.5 bitcoin per block. It will halve again to 6.25 bitcoin at block 630,000, which will be mined sometime in 2020. The rate of new coins decreases like this exponentially over 32 "halvings" until block 6,720,000 (mined approximately in year 2137), when it reaches the minimum currency unit of 1 satoshi. Finally, after 6.93 million blocks, in approximately 2140, almost 2,099,999,997,690,000 satoshis, or almost 21 million bitcoin, will be issued. Thereafter, blocks will contain no new bitcoin, and miners will be rewarded solely through the transaction fees. <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#bitcoin_money_supply">Supply of bitcoin currency over time based on a geometrically decreasing issuance rate</a> shows the total bitcoin in circulation over time, as the issuance of currency decreases.</p>
</div>
<div id="user-content-bitcoin_money_supply">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1001.png"><img src="./Mining_and_Consensus_files/mbc2_1001.png" alt="BitcoinMoneySupply" style="max-width:100%;"></a>
</div>
<div>Figure 1. Supply of bitcoin currency over time based on a geometrically decreasing issuance rate</div>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Note</div>
</td>
<td>
<div>
<p>The maximum number of coins mined is the <em>upper limit</em> of possible mining rewards for bitcoin. In practice, a miner may intentionally mine a block taking less than the full reward. Such blocks have already been mined and more may be mined in the future, resulting in a lower total issuance of the currency.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>In the example code in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#max_money">A script for calculating how much total bitcoin will be issued</a>, we calculate the total amount of bitcoin that will be issued.</p>
</div>
<div id="user-content-max_money">
<div>Example 1. A script for calculating how much total bitcoin will be issued</div>
<div>
<div>
<div>
<div class="highlight highlight-source-python"><pre>link:code<span class="pl-k">/</span>max_money.py[]</pre></div>
</div>
</div>
</div>
</div>
<div>
<p><a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#max_money_run">Running the max_money.py script</a> shows the output produced by running this script.</p>
</div>
<div id="user-content-max_money_run">
<div>Example 2. Running the max_money.py script</div>
<div>
<div>
<div>
<div class="highlight highlight-source-shell"><pre>$ python max_money.py
Total BTC to ever be created: 2099999997690000 Satoshis</pre></div>
</div>
</div>
</div>
</div>
<div>
<p>The finite and diminishing issuance creates a fixed monetary supply that resists inflation. Unlike a fiat currency, which can be printed in infinite numbers by a central bank, bitcoin can never be inflated by printing.</p>
</div>
<div>
<div>
<div>Deflationary Money</div>
<div>
<p>The most important and debated consequence of fixed and diminishing monetary issuance is that the currency tends to be inherently <em>deflationary</em>. Deflation is the phenomenon of appreciation of value due to a mismatch in supply and demand that drives up the value (and exchange rate) of a currency. The opposite of inflation, price deflation, means that the money has more purchasing power over time.</p>
</div>
<div>
<p>Many economists argue that a deflationary economy is a disaster that should be avoided at all costs. That is because in a period of rapid deflation, people tend to hoard money instead of spending it, hoping that prices will fall. Such a phenomenon unfolded during Japanâs "Lost Decade," when a complete collapse of demand pushed the currency into a deflationary spiral.</p>
</div>
<div>
<p>Bitcoin experts argue that deflation is not bad per se. Rather, deflation is associated with a collapse in demand because that is the only example of deflation we have to study. In a fiat currency with the possibility of unlimited printing, it is very difficult to enter a deflationary spiral unless there is a complete collapse in demand and an unwillingness to print money. Deflation in bitcoin is not caused by a collapse in demand, but by a predictably constrained supply.</p>
</div>
<div>
<p>The positive aspect of deflation, of course, is that it is the opposite of inflation. Inflation causes a slow but inevitable debasement of currency, resulting in a form of hidden taxation that punishes savers in order to bail out debtors (including the biggest debtors, governments themselves). Currencies under government control suffer from the moral hazard of easy debt issuance that can later be erased through debasement at the expense of savers.</p>
</div>
<div>
<p>It remains to be seen whether the deflationary aspect of the currency is a problem when it is not driven by rapid economic retraction, or an advantage because the protection from inflation and debasement far outweighs the risks of deflation.</p>
</div>
</div>
</div>
</div>
</div>
<div>
<h3 id="user-content-decentralized-consensus"><a id="user-content-decentralized-consensus" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#decentralized-consensus"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Decentralized Consensus</h3>
<div>
<p>In the previous chapter we looked at the blockchain, the global public ledger (list) of all transactions, which everyone in the bitcoin network accepts as the authoritative record of ownership.</p>
</div>
<div>
<p>But how can everyone in the network agree on a single universal "truth" about who owns what, without having to trust anyone? All traditional payment systems depend on a trust model that has a central authority providing a clearinghouse service, basically verifying and clearing all transactions. Bitcoin has no central authority, yet somehow every full node has a complete copy of a public ledger that it can trust as the authoritative record. The blockchain is not created by a central authority, but is assembled independently by every node in the network. Somehow, every node in the network, acting on information transmitted across insecure network connections, can arrive at the same conclusion and assemble a copy of the same public ledger as everyone else. This chapter examines the process by which the bitcoin network achieves global consensus without central authority.</p>
</div>
<div>
<p>Satoshi Nakamotoâs main invention is the decentralized mechanism for <em>emergent consensus</em>. Emergent, because consensus is not achieved explicitlyâthere is no election or fixed moment when consensus occurs. Instead, consensus is an emergent artifact of the asynchronous interaction of thousands of independent nodes, all following simple rules. All the properties of bitcoin, including currency, transactions, payments, and the security model that does not depend on central authority or trust, derive from this invention.</p>
</div>
<div>
<p>Bitcoinâs decentralized consensus emerges from the interplay of four processes that occur independently on nodes across the network:</p>
</div>
<div>
<ul>
<li>
<p>Independent verification of each transaction, by every full node, based on a comprehensive list of criteria</p>
</li>
<li>
<p>Independent aggregation of those transactions into new blocks by mining nodes, coupled with demonstrated computation through a Proof-of-Work algorithm</p>
</li>
<li>
<p>Independent verification of the new blocks by every node and assembly into a chain</p>
</li>
<li>
<p>Independent selection, by every node, of the chain with the most cumulative computation demonstrated through Proof-of-Work</p>
</li>
</ul>
</div>
<div>
<p>In the next few sections we will examine these processes and how they interact to create the emergent property of network-wide consensus that allows any bitcoin node to assemble its own copy of the authoritative, trusted, public, global ledger.</p>
</div>
</div>
<div>
<h3 id="user-content-tx_verification"><a id="user-content-independent-verification-of-transactions" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#independent-verification-of-transactions"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Independent Verification of Transactions</h3>
<div>
<p>In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#transactions">[transactions]</a>, we saw how wallet software creates transactions by collecting UTXO, providing the appropriate unlocking scripts, and then constructing new outputs assigned to a new owner. The resulting transaction is then sent to the neighboring nodes in the bitcoin network so that it can be propagated across the entire bitcoin network.</p>
</div>
<div>
<p>However, before forwarding transactions to its neighbors, every bitcoin node that receives a transaction will first verify the transaction. This ensures that only valid transactions are propagated across the network, while invalid transactions are discarded at the first node that encounters them.</p>
</div>
<div>
<p>Each node verifies every transaction against a long checklist of criteria:</p>
</div>
<div>
<ul>
<li>
<p>The transactionâs syntax and data structure must be correct.</p>
</li>
<li>
<p>Neither lists of inputs or outputs are empty.</p>
</li>
<li>
<p>The transaction size in bytes is less than MAX_BLOCK_SIZE.</p>
</li>
<li>
<p>Each output value, as well as the total, must be within the allowed range of values (less than 21m coins, more than the <em>dust</em> threshold).</p>
</li>
<li>
<p>None of the inputs have hash=0, N=â1 (coinbase transactions should not be relayed).</p>
</li>
<li>
<p>nLocktime is equal to INT_MAX, or nLocktime and nSequence values are satisfied according to MedianTimePast.</p>
</li>
<li>
<p>The transaction size in bytes is greater than or equal to 100.</p>
</li>
<li>
<p>The number of signature operations (SIGOPS) contained in the transaction is less than the signature operation limit.</p>
</li>
<li>
<p>The unlocking script (scriptSig) can only push numbers on the stack, and the locking script (scriptPubkey) must match IsStandard forms (this rejects "nonstandard" transactions).</p>
</li>
<li>
<p>A matching transaction in the pool, or in a block in the main branch, must exist.</p>
</li>
<li>
<p>For each input, if the referenced output exists in any other transaction in the pool, the transaction must be rejected.</p>
</li>
<li>
<p>For each input, look in the main branch and the transaction pool to find the referenced output transaction. If the output transaction is missing for any input, this will be an orphan transaction. Add to the orphan transactions pool, if a matching transaction is not already in the pool.</p>
</li>
<li>
<p>For each input, if the referenced output transaction is a coinbase output, it must have at least COINBASE_MATURITY (100) confirmations.</p>
</li>
<li>
<p>For each input, the referenced output must exist and cannot already be spent.</p>
</li>
<li>
<p>Using the referenced output transactions to get input values, check that each input value, as well as the sum, are in the allowed range of values (less than 21m coins, more than 0).</p>
</li>
<li>
<p>Reject if the sum of input values is less than sum of output values.</p>
</li>
<li>
<p>Reject if transaction fee would be too low (minRelayTxFee) to get into an empty block.</p>
</li>
<li>
<p>The unlocking scripts for each input must validate against the corresponding output locking scripts.</p>
</li>
</ul>
</div>
<div>
<p>These conditions can be seen in detail in the functions AcceptToMemoryPool, CheckTransaction, and CheckInputs in Bitcoin Core. Note that the conditions change over time, to address new types of denial-of-service attacks or sometimes to relax the rules so as to include more types of transactions.</p>
</div>
<div>
<p>By independently verifying each transaction as it is received and before propagating it, every node builds a pool of valid (but unconfirmed) transactions known as the <em>transaction pool</em>, <em>memory pool</em>, or <em>mempool</em>.</p>
</div>
</div>
<div>
<h3 id="user-content-mining-nodes"><a id="user-content-mining-nodes" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#mining-nodes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mining Nodes</h3>
<div>
<p>Some of the nodes on the bitcoin network are specialized nodes called <em>miners</em>. In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#ch01_intro_what_is_bitcoin">[ch01_intro_what_is_bitcoin]</a> we introduced Jing, a computer engineering student in Shanghai, China, who is a bitcoin miner. Jing earns bitcoin by running a "mining rig," which is a specialized computer-hardware system designed to mine bitcoin. Jingâs specialized mining hardware is connected to a server running a full bitcoin node. Unlike Jing, some miners mine without a full node, as we will see in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#mining_pools">Mining Pools</a>. Like every other full node, Jingâs node receives and propagates unconfirmed transactions on the bitcoin network. Jingâs node, however, also aggregates these transactions into new blocks.</p>
</div>
<div>
<p>Jingâs node is listening for new blocks, propagated on the bitcoin network, as do all nodes. However, the arrival of a new block has special significance for a mining node. The competition among miners effectively ends with the propagation of a new block that acts as an announcement of a winner. To miners, receiving a valid new block means someone else won the competition and they lost. However, the end of one round of a competition is also the beginning of the next round. The new block is not just a checkered flag, marking the end of the race; it is also the starting pistol in the race for the next block.</p>
</div>
</div>
<div>
<h3 id="user-content-aggregating-transactions-into-blocks"><a id="user-content-aggregating-transactions-into-blocks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#aggregating-transactions-into-blocks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Aggregating Transactions into Blocks</h3>
<div>
<p>After validating transactions, a bitcoin node will add them to the <em>memory pool</em>, or <em>transaction pool</em>, where transactions await until they can be included (mined) into a block. Jingâs node collects, validates, and relays new transactions just like any other node. Unlike other nodes, however, Jingâs node will then aggregate these transactions into a <em>candidate block</em>.</p>
</div>
<div>
<p>Letâs follow the blocks that were created during the time Alice bought a cup of coffee from Bobâs Cafe (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#cup_of_coffee">[cup_of_coffee]</a>). Aliceâs transaction was included in block 277,316. For the purpose of demonstrating the concepts in this chapter, letâs assume that block was mined by Jingâs mining system and follows Aliceâs transaction as it becomes part of this new block.</p>
</div>
<div>
<p>Jingâs mining node maintains a local copy of the blockchain. By the time Alice buys the cup of coffee, Jingâs node has assembled a chain up to block 277,314. Jingâs node is listening for transactions, trying to mine a new block and also listening for blocks discovered by other nodes. As Jingâs node is mining, it receives block 277,315 through the bitcoin network. The arrival of this block signifies the end of the competition for block 277,315 and the beginning of the competition to create block 277,316.</p>
</div>
<div>
<p>During the previous 10 minutes, while Jingâs node was searching for a solution to block 277,315, it was also collecting transactions in preparation for the next block. By now it has collected a few hundred transactions in the memory pool. Upon receiving block 277,315 and validating it, Jingâs node will also compare it against all the transactions in the memory pool and remove any that were included in block 277,315. Whatever transactions remain in the memory pool are unconfirmed and are waiting to be recorded in a new block.</p>
</div>
<div>
<p>Jingâs node immediately constructs a new empty block, a candidate for block 277,316. This block is called a <em>candidate block</em> because it is not yet a valid block, as it does not contain a valid Proof-of-Work. The block becomes valid only if the miner succeeds in finding a solution to the Proof-of-Work algorithm.</p>
</div>
<div>
<p>When Jingâs node aggregates all the transactions from the memory pool, the new candidate block has 418 transactions with total transaction fees of 0.09094928 bitcoin. You can see this block in the blockchain using the Bitcoin Core client command-line interface, as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#block277316">Using the command line to retrieve block 277,316</a>.</p>
</div>
<div id="user-content-block277316">
<div>Example 3. Using the command line to retrieve block 277,316</div>
<div>
<div>
<div>
<div class="highlight highlight-source-shell"><pre>$ bitcoin-cli getblockhash 277316

0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4

$ bitcoin-cli getblock 0000000000000001b6b9a13b095e96db41c4a928b97ef2d9\
44a9b31b2cc7bdc4</pre></div>
</div>
</div>
<div>
<div>
<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>hash<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>confirmations<span class="pl-pds">"</span></span> : <span class="pl-c1">35561</span>,
    <span class="pl-s"><span class="pl-pds">"</span>size<span class="pl-pds">"</span></span> : <span class="pl-c1">218629</span>,
    <span class="pl-s"><span class="pl-pds">"</span>height<span class="pl-pds">"</span></span> : <span class="pl-c1">277316</span>,
    <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span> : <span class="pl-c1">2</span>,
    <span class="pl-s"><span class="pl-pds">"</span>merkleroot<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>tx<span class="pl-pds">"</span></span> : [
        <span class="pl-s"><span class="pl-pds">"</span>d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>b268b45c59b39d759614757718b9918caf0ba9d97c56f3b91956ff877c503fbe<span class="pl-pds">"</span></span>,

        <span class="pl-ii">...</span> <span class="pl-c1">417</span> <span class="pl-ii">more</span> <span class="pl-ii">transactions</span> <span class="pl-ii">...</span>

       ],
    <span class="pl-s"><span class="pl-pds">"</span>time<span class="pl-pds">"</span></span> : <span class="pl-c1">1388185914</span>,
    <span class="pl-s"><span class="pl-pds">"</span>nonce<span class="pl-pds">"</span></span> : <span class="pl-c1">924591752</span>,
    <span class="pl-s"><span class="pl-pds">"</span>bits<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>1903a30c<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>difficulty<span class="pl-pds">"</span></span> : <span class="pl-c1">1180923195.25802612</span>,
    <span class="pl-s"><span class="pl-pds">"</span>chainwork<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>000000000000000000000000000000000000000000000934695e92aaf53afa1a<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>previousblockhash<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569<span class="pl-pds">"</span></span>
}</pre></div>
</div>
</div>
</div>
</div>
<div>
<h4 id="user-content-the-coinbase-transaction"><a id="user-content-the-coinbase-transaction" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#the-coinbase-transaction"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Coinbase Transaction</h4>
<div>
<p>The first transaction in any block is a special transaction, called a <em>coinbase transaction</em>. This transaction is constructed by Jingâs node and contains his <em>reward</em> for the mining effort.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Note</div>
</td>
<td>
<div>
<p>When block 277,316 was mined, the reward was 25 bitcoin per block. Since then, one "halving" period has elapsed. The block reward changed to 12.5 bitcoin in July 2016. It will be halved again in 210,000 blocks, in the year 2020.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>Jingâs node creates the coinbase transaction as a payment to his own wallet: "Pay Jingâs address 25.09094928 bitcoin." The total amount of reward that Jing collects for mining a block is the sum of the coinbase reward (25 new bitcoin) and the transaction fees (0.09094928) from all the transactions included in the block as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#generation_tx_example">Coinbase transaction</a>.</p>
</div>
<div id="user-content-generation_tx_example">
<div>Example 4. Coinbase transaction</div>
<div>
<div>
<div>
<pre>$ bitcoin-cli getrawtransaction d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f 1</pre>
</div>
</div>
<div>
<div>
<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>hex<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0f03443b0403858402062f503253482fffffffff0110c08d9500000000232102aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21ac00000000<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>txid<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span> : <span class="pl-c1">1</span>,
    <span class="pl-s"><span class="pl-pds">"</span>locktime<span class="pl-pds">"</span></span> : <span class="pl-c1">0</span>,
    <span class="pl-s"><span class="pl-pds">"</span>vin<span class="pl-pds">"</span></span> : [
        {
            <span class="pl-s"><span class="pl-pds">"</span>coinbase<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>03443b0403858402062f503253482f<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>sequence<span class="pl-pds">"</span></span> : <span class="pl-c1">4294967295</span>
        }
    ],
    <span class="pl-s"><span class="pl-pds">"</span>vout<span class="pl-pds">"</span></span> : [
        {
            <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span> : <span class="pl-c1">25.09094928</span>,
            <span class="pl-s"><span class="pl-pds">"</span>n<span class="pl-pds">"</span></span> : <span class="pl-c1">0</span>,
            <span class="pl-s"><span class="pl-pds">"</span>scriptPubKey<span class="pl-pds">"</span></span> : {
                <span class="pl-s"><span class="pl-pds">"</span>asm<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>02aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21OP_CHECKSIG<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>hex<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>2102aa970c592640d19de03ff6f329d6fd2eecb023263b9ba5d1b81c29b523da8b21ac<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>reqSigs<span class="pl-pds">"</span></span> : <span class="pl-c1">1</span>,
                <span class="pl-s"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span> : <span class="pl-s"><span class="pl-pds">"</span>pubkey<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>addresses<span class="pl-pds">"</span></span> : [
                    <span class="pl-s"><span class="pl-pds">"</span>1MxTkeEP2PmHSMze5tUZ1hAV3YTKu2Gh1N<span class="pl-pds">"</span></span>
                ]
            }
        }
    ]
}</pre></div>
</div>
</div>
</div>
</div>
<div>
<p>Unlike regular transactions, the coinbase transaction does not consume (spend) UTXO as inputs. Instead, it has only one input, called the <em>coinbase</em>, which creates bitcoin from nothing. The coinbase transaction has one output, payable to the minerâs own bitcoin address. The output of the coinbase transaction sends the value of 25.09094928 bitcoin to the minerâs bitcoin address; in this case it is 1MxTkeEP2PmHSMze5tUZ1hAV3YTKu2Gh1N.</p>
</div>
</div>
<div>
<h4 id="user-content-coinbase-reward-and-fees"><a id="user-content-coinbase-reward-and-fees" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#coinbase-reward-and-fees"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Coinbase Reward and Fees</h4>
<div>
<p>To construct the coinbase transaction, Jingâs node first calculates the total amount of transaction fees by adding all the inputs and outputs of the 418 transactions that were added to the block. The fees are calculated as:</p>
</div>
<div>
<div>
<pre>Total Fees = Sum(Inputs) - Sum(Outputs)</pre>
</div>
</div>
<div>
<p>In block 277,316, the total transaction fees are 0.09094928 bitcoin.</p>
</div>
<div>
<p>Next, Jingâs node calculates the correct reward for the new block. The reward is calculated based on the block height, starting at 50 bitcoin per block and reduced by half every 210,000 blocks. Because this block is at height 277,316, the correct reward is 25 bitcoin.</p>
</div>
<div>
<p>The calculation can be seen in function GetBlockSubsidy in the Bitcoin Core client, as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#getblocksubsidy_source">Calculating the block rewardâFunction GetBlockSubsidy, Bitcoin Core Client, main.cpp</a>.</p>
</div>
<div id="user-content-getblocksubsidy_source">
<div>Example 5. Calculating the block rewardâFunction GetBlockSubsidy, Bitcoin Core Client, main.cpp</div>
<div>
<div>
<div>
<div class="highlight highlight-source-c++"><pre>CAmount <span class="pl-en">GetBlockSubsidy</span>(<span class="pl-k">int</span> nHeight, <span class="pl-k">const</span> Consensus::Params&amp; consensusParams)
{
    <span class="pl-k">int</span> halvings = nHeight / consensusParams.<span class="pl-smi">nSubsidyHalvingInterval</span>;
    <span class="pl-c"><span class="pl-c">//</span> Force block reward to zero when right shift is undefined.</span>
    <span class="pl-k">if</span> (halvings &gt;= <span class="pl-c1">64</span>)
        <span class="pl-k">return</span> <span class="pl-c1">0</span>;

    CAmount nSubsidy = <span class="pl-c1">50</span> * COIN;
    <span class="pl-c"><span class="pl-c">//</span> Subsidy is cut in half every 210,000 blocks which will occur approximately every 4 years.</span>
    nSubsidy &gt;&gt;= halvings;
    <span class="pl-k">return</span> nSubsidy;
}</pre></div>
</div>
</div>
</div>
</div>
<div>
<p>The initial subsidy is calculated in satoshis by multiplying 50 with the COIN constant (100,000,000 satoshis). This sets the initial reward (nSubsidy) at 5 billion satoshis.</p>
</div>
<div>
<p>Next, the function calculates the number of halvings that have occurred by dividing the current block height by the halving interval (SubsidyHalvingInterval). In the case of block 277,316, with a halving interval every 210,000 blocks, the result is 1 halving.</p>
</div>
<div>
<p>The maximum number of halvings allowed is 64, so the code imposes a zero reward (returns only the fees) if the 64 halvings is exceeded.</p>
</div>
<div>
<p>Next, the function uses the binary-right-shift operator to divide the reward (nSubsidy) by two for each round of halving. In the case of block 277,316, this would binary-right-shift the reward of 5 billion satoshis once (one halving) and result in 2.5 billion satoshis, or 25 bitcoins. The binary-right-shift operator is used because it is more efficient than multiple repeated divisions. To avoid a potential bug, the shift operation is skipped after 63 halvings, and the subsidy is set to 0.</p>
</div>
<div>
<p>Finally, the coinbase reward (nSubsidy) is added to the transaction fees (nFees), and the sum is returned.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>If Jingâs mining node writes the coinbase transaction, what stops Jing from "rewarding" himself 100 or 1000 bitcoin? The answer is that an incorrect reward would result in the block being deemed invalid by everyone else, wasting Jingâs electricity used for Proof-of-Work. Jing only gets to spend the reward if the block is accepted by everyone.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div>
<h4 id="user-content-structure-of-the-coinbase-transaction"><a id="user-content-structure-of-the-coinbase-transaction" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#structure-of-the-coinbase-transaction"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Structure of the Coinbase Transaction</h4>
<div>
<p>With these calculations, Jingâs node then constructs the coinbase transaction to pay himself 25.09094928 bitcoin.</p>
</div>
<div>
<p>As you can see in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#generation_tx_example">Coinbase transaction</a>, the coinbase transaction has a special format. Instead of a transaction input specifying a previous UTXO to spend, it has a "coinbase" input. We examined transaction inputs in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#tx_in_structure">[tx_in_structure]</a>. Letâs compare a regular transaction input with a coinbase transaction input. <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#table_8-1">The structure of a "normal" transaction input</a> shows the structure of a regular transaction, while <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#table_8-2">The structure of a coinbase transaction input</a> shows the structure of the coinbase transactionâs input.</p>
</div>

Table 1. The structure of a "normal" transaction input





<table id="user-content-table_8-1"><thead>
<tr>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>32 bytes</p></td>
<td><p>Transaction Hash</p></td>
<td><p>Pointer to the transaction containing the UTXO to be spent</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Output Index</p></td>
<td><p>The index number of the UTXO to be spent, first one is 0</p></td>
</tr>
<tr>
<td><p>1â9 bytes (VarInt)</p></td>
<td><p>Unlocking-Script Size</p></td>
<td><p>Unlocking-Script length in bytes, to follow</p></td>
</tr>
<tr>
<td><p>Variable</p></td>
<td><p>Unlocking-Script</p></td>
<td><p>A script that fulfills the conditions of the UTXO locking script</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Sequence Number</p></td>
<td><p>Usually set to 0xFFFFFFFF to opt out of BIP 125 and BIP 68</p></td>
</tr>
</tbody>
</table>

Table 2. The structure of a coinbase transaction input





<table id="user-content-table_8-2"><thead>
<tr>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>32 bytes</p></td>
<td><p>Transaction Hash</p></td>
<td><p>All bits are zero: Not a transaction hash reference</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Output Index</p></td>
<td><p>All bits are ones: 0xFFFFFFFF</p></td>
</tr>
<tr>
<td><p>1â9 bytes (VarInt)</p></td>
<td><p>Coinbase Data Size</p></td>
<td><p>Length of the coinbase data, from 2 to 100 bytes</p></td>
</tr>
<tr>
<td><p>Variable</p></td>
<td><p>Coinbase Data</p></td>
<td><p>Arbitrary data used for extra nonce and mining tags. In v2 blocks; must begin with block height</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Sequence Number</p></td>
<td><p>Set to 0xFFFFFFFF</p></td>
</tr>
</tbody>
</table>
<div>
<p>In a coinbase transaction, the first two fields are set to values that do not represent a UTXO reference. Instead of a "transaction hash," the first field is filled with 32 bytes all set to zero. The "output index" is filled with 4 bytes all set to 0xFF (255 decimal). The "Unlocking Script" (scriptSig) is replaced by coinbase data, a data field used by the miners, as we will see next.</p>
</div>
</div>
<div>
<h4 id="user-content-coinbase-data"><a id="user-content-coinbase-data" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#coinbase-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Coinbase Data</h4>
<div>
<p>Coinbase transactions do not have an unlocking script (aka, scriptSig) field. Instead, this field is replaced by coinbase data, which must be between 2 and 100 bytes. Except for the first few bytes, the rest of the coinbase data can be used by miners in any way they want; it is arbitrary data.</p>
</div>
<div>
<p>In the genesis block, for example, Satoshi Nakamoto added the text "The Times 03/Jan/2009 Chancellor on brink of second bailout for banks" in the coinbase data, using it as a proof of the date and to convey a message. Currently, miners use the coinbase data to include extra nonce values and strings identifying the mining pool.</p>
</div>
<div>
<p>The first few bytes of the coinbase used to be arbitrary, but that is no longer the case. As per BIP-34, version-2 blocks (blocks with the version field set to 2) must contain the block height index as a script "push" operation in the beginning of the coinbase field.</p>
</div>
<div>
<p>In block 277,316 we see that the coinbase (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#generation_tx_example">Coinbase transaction</a>), which is in the unlocking script or scriptSig field of the transaction input, contains the hexadecimal value 03443b0403858402062f503253482f. Letâs decode this value.</p>
</div>
<div>
<p>The first byte, 03, instructs the script execution engine to push the next three bytes onto the script stack (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#tx_script_ops_table_pushdata">[tx_script_ops_table_pushdata]</a>). The next three bytes, 0x443b04, are the block height encoded in little-endian format (backward, least-significant byte first). Reverse the order of the bytes and the result is 0x043b44, which is 277,316 in decimal.</p>
</div>
<div>
<p>The next few hexadecimal digits (0385840206) are used to encode an extra <em>nonce</em> (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#extra_nonce">The Extra Nonce Solution</a>), or random value, used to find a suitable Proof-of-Work solution.</p>
</div>
<div>
<p>The final part of the coinbase data (2f503253482f) is the ASCII-encoded string <span><code>/P2SH/</code></span>, which indicates that the mining node that mined this block supports the P2SH improvement defined in BIP-16. The introduction of the P2SH capability required signaling by miners to endorse either BIP-16 or BIP-17. Those endorsing the BIP-16 implementation were to include /P2SH/ in their coinbase data. Those endorsing the BIP-17 implementation of P2SH were to include the string p2sh/CHV in their coinbase data. The BIP-16 was elected as the winner, and many miners continued including the string /P2SH/ in their coinbase to indicate support for this feature.</p>
</div>
<div>
<p><a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#satoshi_words">Extract the coinbase data from the genesis block</a> uses the libbitcoin library introduced in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#alt_libraries">[alt_libraries]</a> to extract the coinbase data from the genesis block, displaying Satoshiâs message. Note that the libbitcoin library contains a static copy of the genesis block, so the example code can retrieve the genesis block directly from the library.</p>
</div>
<div id="user-content-satoshi_words">
<div>Example 6. Extract the coinbase data from the genesis block</div>
<div>
<div>
<div>
<div class="highlight highlight-source-c++"><pre>link:code/satoshi-words.cpp[]</pre></div>
</div>
</div>
</div>
</div>
<div>
<p>We compile the code with the GNU C++ compiler and run the resulting executable, as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#satoshi_words_run">Compiling and running the satoshi-words example code</a>.</p>
</div>
<div id="user-content-satoshi_words_run">
<div>Example 7. Compiling and running the satoshi-words example code</div>
<div>
<div>
<div>
<div class="highlight highlight-source-shell"><pre>$ <span class="pl-c"><span class="pl-c">#</span> Compile the code</span>
$  g++ -o satoshi-words satoshi-words.cpp <span class="pl-s"><span class="pl-pds">$(</span>pkg-config --cflags --libs libbitcoin<span class="pl-pds">)</span></span>
$ <span class="pl-c"><span class="pl-c">#</span> Run the executable</span>
$ ./satoshi-words
^Dï¿½ï¿½<span class="pl-k">&lt;</span>GS<span class="pl-k">&gt;</span>^A^DEThe Times 03/Jan/2009 Chancellor on brink of second bailout <span class="pl-k">for</span> banks</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div>
<h3 id="user-content-constructing-the-block-header"><a id="user-content-constructing-the-block-header" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#constructing-the-block-header"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Constructing the Block Header</h3>
<div>
<p>To construct the block header, the mining node needs to fill in six fields, as listed in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#block_header_structure_ch10">The structure of the block header</a>.</p>
</div>

Table 3. The structure of the block header





<table id="user-content-block_header_structure_ch10"><thead>
<tr>
<th>Size</th>
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>4 bytes</p></td>
<td><p>Version</p></td>
<td><p>A version number to track software/protocol upgrades</p></td>
</tr>
<tr>
<td><p>32 bytes</p></td>
<td><p>Previous Block Hash</p></td>
<td><p>A reference to the hash of the previous (parent) block in the chain</p></td>
</tr>
<tr>
<td><p>32 bytes</p></td>
<td><p>Merkle Root</p></td>
<td><p>A hash of the root of the merkle tree of this blockâs transactions</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Timestamp</p></td>
<td><p>The approximate creation time of this block (seconds from Unix Epoch)</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Target</p></td>
<td><p>The Proof-of-Work algorithm target for this block</p></td>
</tr>
<tr>
<td><p>4 bytes</p></td>
<td><p>Nonce</p></td>
<td><p>A counter used for the Proof-of-Work algorithm</p></td>
</tr>
</tbody>
</table>
<div>
<p>At the time that block 277,316 was mined, the version number describing the block structure is version 2, which is encoded in little-endian format in 4 bytes as 0x02000000.</p>
</div>
<div>
<p>Next, the mining node needs to add the "Previous Block Hash" (also known as prevhash). That is the hash of the block header of block 277,315, the previous block received from the network, which Jingâs node has accepted and selected as the <em>parent</em> of the candidate block 277,316. The block header hash for block 277,315 is:</p>
</div>
<div>
<div>
<pre>0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569</pre>
</div>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>By selecting the specific <em>parent</em> block, indicated by the Previous Block Hash field in the candidate block header, Jing is committing his mining power to extending the chain that ends in that specific block. In essence, this is how Jing "votes" with his mining power for the longest-difficulty valid chain.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>The next step is to summarize all the transactions with a merkle tree, in order to add the merkle root to the block header. The coinbase transaction is listed as the first transaction in the block. Then, 418 more transactions are added after it, for a total of 419 transactions in the block. As we saw in the <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#merkle_trees">[merkle_trees]</a>, there must be an even number of "leaf" nodes in the tree, so the last transaction is duplicated, creating 420 nodes, each containing the hash of one transaction. The transaction hashes are then combined, in pairs, creating each level of the tree, until all the transactions are summarized into one node at the "root" of the tree. The root of the merkle tree summarizes all the transactions into a single 32-byte value, which you can see listed as "merkle root" in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#block277316">Using the command line to retrieve block 277,316</a>, and here:</p>
</div>
<div>
<div>
<pre>c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e</pre>
</div>
</div>
<div>
<p>Jingâs mining node will then add a 4-byte timestamp, encoded as a Unix "epoch" timestamp, which is based on the number of seconds elapsed since midnight UTC, Thursday, January 1, 1970. The time 1388185914 is equal to Friday, December 27, 2013, 23:11:54 UTC.</p>
</div>
<div>
<p>Jingâs node then fills in the target, which defines the required Proof-of-Work to make this a valid block. The target is stored in the block as a "target bits" metric, which is a mantissa-exponent encoding of the target. The encoding has a 1-byte exponent, followed by a 3-byte mantissa (coefficient). In block 277,316, for example, the target bits value is 0x1903a30c. The first part 0x19 is a hexadecimal exponent, while the next part, 0x03a30c, is the coefficient. The concept of a target is explained in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#target">Retargeting to Adjust Difficulty</a> and the "target bits" representation is explained in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#target_bits">Target Representation</a>.</p>
</div>
<div>
<p>The final field is the nonce, which is initialized to zero.</p>
</div>
<div>
<p>With all the other fields filled, the block header is now complete and the process of mining can begin. The goal is now to find a value for the nonce that results in a block header hash that is less than the target. The mining node will need to test billions or trillions of nonce values before a nonce is found that satisfies the requirement.</p>
</div>
</div>
<div>
<h3 id="user-content-mining-the-block"><a id="user-content-mining-the-block" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#mining-the-block"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mining the Block</h3>
<div>
<p>Now that a candidate block has been constructed by Jingâs node, it is time for Jingâs hardware mining rig to "mine" the block, to find a solution to the Proof-of-Work algorithm that makes the block valid. Throughout this book we have studied cryptographic hash functions as used in various aspects of the bitcoin system. The hash function SHA256 is the function used in bitcoinâs mining process.</p>
</div>
<div>
<p>In the simplest terms, mining is the process of hashing the block header repeatedly, changing one parameter, until the resulting hash matches a specific target. The hash functionâs result cannot be determined in advance, nor can a pattern be created that will produce a specific hash value. This feature of hash functions means that the only way to produce a hash result matching a specific target is to try again and again, randomly modifying the input until the desired hash result appears by chance.</p>
</div>
<div>
<h4 id="user-content-proof-of-work-algorithm"><a id="user-content-proof-of-work-algorithm" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#proof-of-work-algorithm"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Proof-of-Work Algorithm</h4>
<div>
<p>A hash algorithm takes an arbitrary-length data input and produces a fixed-length deterministic result, a digital fingerprint of the input. For any specific input, the resulting hash will always be the same and can be easily calculated and verified by anyone implementing the same hash algorithm. The key characteristic of a cryptographic hash algorithm is that it is computationally infeasible to find two different inputs that produce the same fingerprint (known as a <em>collision</em>). As a corollary, it is also virtually impossible to select an input in such a way as to produce a desired fingerprint, other than trying random inputs.</p>
</div>
<div>
<p>With SHA256, the output is always 256 bits long, regardless of the size of the input. In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#sha256_example1">SHA256 example</a>, we will use the Python interpreter to calculate the SHA256 hash of the phrase, "I am Satoshi Nakamoto."</p>
</div>
<div id="user-content-sha256_example1">
<div>Example 8. SHA256 example</div>
<div>
<div>
<div>
<div class="highlight highlight-source-shell"><pre>$ python</pre></div>
</div>
</div>
<div>
<div>
<div class="highlight highlight-text-python-console"><pre>Python 2.7.1
&gt;&gt;&gt; <span class="pl-k">import</span> hashlib
&gt;&gt;&gt; <span class="pl-c1">print</span> hashlib.sha256(<span class="pl-s"><span class="pl-pds">"</span>I am Satoshi Nakamoto<span class="pl-pds">"</span></span>).hexdigest()
5d7c7ba21cbbcd75d14800b100252d5b428e5b1213d27c385bc141ca6b47989e</pre></div>
</div>
</div>
</div>
</div>
<div>
<p><a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#sha256_example1">SHA256 example</a> shows the result of calculating the hash of "I am Satoshi Nakamoto": 5d7c7ba21cbbcd75d14800b100252d5b428e5b1213d27c385bc141ca6b47989e. This 256-bit number is the <em>hash</em> or <em>digest</em> of the phrase and depends on every part of the phrase. Adding a single letter, punctuation mark, or any other character will produce a different hash.</p>
</div>
<div>
<p>Now, if we change the phrase, we should expect to see completely different hashes. Letâs try that by adding a number to the end of our phrase, using the simple Python scripting in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#sha256_example_generator">SHA256 script for generating many hashes by iterating on a nonce</a>.</p>
</div>
<div id="user-content-sha256_example_generator">
<div>Example 9. SHA256 script for generating many hashes by iterating on a nonce</div>
<div>
<div>
<div>
<div class="highlight highlight-source-python"><pre>link:code<span class="pl-k">/</span>hash_example.py[]</pre></div>
</div>
</div>
</div>
</div>
<div>
<p>Running this will produce the hashes of several phrases, made different by adding a number at the end of the text. By incrementing the number, we can get different hashes, as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#sha256_example_generator_output">SHA256 output of a script for generating many hashes by iterating on a nonce</a>.</p>
</div>
<div id="user-content-sha256_example_generator_output">
<div>Example 10. SHA256 output of a script for generating many hashes by iterating on a nonce</div>
<div>
<div>
<div>
<div class="highlight highlight-source-shell"><pre>$ python hash_example.py</pre></div>
</div>
</div>
<div>
<div>
<pre>I am Satoshi Nakamoto0 =&gt; a80a81401765c8eddee25df36728d732...
I am Satoshi Nakamoto1 =&gt; f7bc9a6304a4647bb41241a677b5345f...
I am Satoshi Nakamoto2 =&gt; ea758a8134b115298a1583ffb80ae629...
I am Satoshi Nakamoto3 =&gt; bfa9779618ff072c903d773de30c99bd...
I am Satoshi Nakamoto4 =&gt; bce8564de9a83c18c31944a66bde992f...
I am Satoshi Nakamoto5 =&gt; eb362c3cf3479be0a97a20163589038e...
I am Satoshi Nakamoto6 =&gt; 4a2fd48e3be420d0d28e202360cfbaba...
I am Satoshi Nakamoto7 =&gt; 790b5a1349a5f2b909bf74d0d166b17a...
I am Satoshi Nakamoto8 =&gt; 702c45e5b15aa54b625d68dd947f1597...
I am Satoshi Nakamoto9 =&gt; 7007cf7dd40f5e933cd89fff5b791ff0...
I am Satoshi Nakamoto10 =&gt; c2f38c81992f4614206a21537bd634a...
I am Satoshi Nakamoto11 =&gt; 7045da6ed8a914690f087690e1e8d66...
I am Satoshi Nakamoto12 =&gt; 60f01db30c1a0d4cbce2b4b22e88b9b...
I am Satoshi Nakamoto13 =&gt; 0ebc56d59a34f5082aaef3d66b37a66...
I am Satoshi Nakamoto14 =&gt; 27ead1ca85da66981fd9da01a8c6816...
I am Satoshi Nakamoto15 =&gt; 394809fb809c5f83ce97ab554a2812c...
I am Satoshi Nakamoto16 =&gt; 8fa4992219df33f50834465d3047429...
I am Satoshi Nakamoto17 =&gt; dca9b8b4f8d8e1521fa4eaa46f4f0cd...
I am Satoshi Nakamoto18 =&gt; 9989a401b2a3a318b01e9ca9a22b0f3...
I am Satoshi Nakamoto19 =&gt; cda56022ecb5b67b2bc93a2d764e75f...</pre>
</div>
</div>
</div>
</div>
<div>
<p>Each phrase produces a completely different hash result. They seem completely random, but you can reproduce the exact results in this example on any computer with Python and see the same exact hashes.</p>
</div>
<div>
<p>The number used as a variable in such a scenario is called a <em>nonce</em>. The nonce is used to vary the output of a cryptographic function, in this case to vary the SHA256 fingerprint of the phrase.</p>
</div>
<div>
<p>To make a challenge out of this algorithm, letâs set a target: find a phrase that produces a hexadecimal hash that starts with a zero. Fortunately, this isnât difficult! <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#sha256_example_generator_output">SHA256 output of a script for generating many hashes by iterating on a nonce</a> shows that the phrase "I am Satoshi Nakamoto13" produces the hash 0ebc56d59a34f5082aaef3d66b37a661696c2b618e62432727216ba9531041a5, which fits our criteria. It took 13 attempts to find it. In terms of probabilities, if the output of the hash function is evenly distributed we would expect to find a result with a 0 as the hexadecimal prefix once every 16 hashes (one out of 16 hexadecimal digits 0 through F). In numerical terms, that means finding a hash value that is less than 0x1000000000000000000000000000000000000000000000000000000000000000. We call this threshold the <em>target</em> and the goal is to find a hash that is numerically less than the target. If we decrease the target, the task of finding a hash that is less than the target becomes more and more difficult.</p>
</div>
<div>
<p>To give a simple analogy, imagine a game where players throw a pair of dice repeatedly, trying to throw less than a specified target. In the first round, the target is 12. Unless you throw double-six, you win. In the next round the target is 11. Players must throw 10 or less to win, again an easy task. Letâs say a few rounds later the target is down to 5. Now, more than half the dice throws will exceed the target and therefore be invalid. It takes exponentially more dice throws to win, the lower the target gets. Eventually, when the target is 2 (the minimum possible), only one throw out of every 36, or 2% of them, will produce a winning result.</p>
</div>
<div>
<p>From the perspective of an observer who knows that the target of the dice game is 2, if someone has succeeded in casting a winning throw it can be assumed that they attempted, on average, 36 throws. In other words, one can estimate the amount of work it takes to succeed from the difficulty imposed by the target. When the algorithm is based on a deterministic function such as SHA256, the input itself constitutes <em>proof</em> that a certain amount of <em>work</em> was done to produce a result below the target. Hence, <em>Proof-of-Work</em>.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>Even though each attempt produces a random outcome, the probability of any possible outcome can be calculated in advance. Therefore, an outcome of specified difficulty constitutes proof of a specific amount of work.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#sha256_example_generator_output">SHA256 output of a script for generating many hashes by iterating on a nonce</a>, the winning "nonce" is 13 and this result can be confirmed by anyone independently. Anyone can add the number 13 as a suffix to the phrase "I am Satoshi Nakamoto" and compute the hash, verifying that it is less than the target. The successful result is also Proof-of-Work, because it proves we did the work to find that nonce. While it only takes one hash computation to verify, it took us 13 hash computations to find a nonce that worked. If we had a lower target (higher difficulty) it would take many more hash computations to find a suitable nonce, but only one hash computation for anyone to verify. Furthermore, by knowing the target, anyone can estimate the difficulty using statistics and therefore know how much work was needed to find such a nonce.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>The Proof-of-Work must produce a hash that is <em>less than</em> the target. A higher target means it is less difficult to find a hash that is below the target. A lower target means it is more difficult to find a hash below the target. The target and difficulty are inversely related.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>Bitcoinâs Proof-of-Work is very similar to the challenge shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#sha256_example_generator_output">SHA256 output of a script for generating many hashes by iterating on a nonce</a>. The miner constructs a candidate block filled with transactions. Next, the miner calculates the hash of this blockâs header and sees if it is smaller than the current <em>target</em>. If the hash is not less than the target, the miner will modify the nonce (usually just incrementing it by one) and try again. At the current difficulty in the bitcoin network, miners have to try quadrillions of times before finding a nonce that results in a low enough block header hash.</p>
</div>
<div>
<p>A very simplified Proof-of-Work algorithm is implemented in Python in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#pow_example1">Simplified Proof-of-Work implementation</a>.</p>
</div>
<div id="user-content-pow_example1">
<div>Example 11. Simplified Proof-of-Work implementation</div>
<div>
<div>
<div>
<div class="highlight highlight-source-python"><pre>link:code<span class="pl-k">/</span>proof<span class="pl-k">-</span>of<span class="pl-k">-</span>work<span class="pl-k">-</span>example.py[]</pre></div>
</div>
</div>
</div>
</div>
<div>
<p>Running this code, you can set the desired difficulty (in bits, how many of the leading bits must be zero) and see how long it takes for your computer to find a solution. In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#pow_example_outputs">Running the Proof-of-Work example for various difficulties</a>, you can see how it works on an average laptop.</p>
</div>
<div id="user-content-pow_example_outputs">
<div>Example 12. Running the Proof-of-Work example for various difficulties</div>
<div>
<div>
<div>
<div class="highlight highlight-source-shell"><pre>$ python proof-of-work-example.py<span class="pl-k">*</span></pre></div>
</div>
</div>
<div>
<div>
<pre>Difficulty: 1 (0 bits)

[...]

Difficulty: 8 (3 bits)
Starting search...
Success with nonce 9
Hash is 1c1c105e65b47142f028a8f93ddf3dabb9260491bc64474738133ce5256cb3c1
Elapsed Time: 0.0004 seconds
Hashing Power: 25065 hashes per second
Difficulty: 16 (4 bits)
Starting search...
Success with nonce 25
Hash is 0f7becfd3bcd1a82e06663c97176add89e7cae0268de46f94e7e11bc3863e148
Elapsed Time: 0.0005 seconds
Hashing Power: 52507 hashes per second
Difficulty: 32 (5 bits)
Starting search...
Success with nonce 36
Hash is 029ae6e5004302a120630adcbb808452346ab1cf0b94c5189ba8bac1d47e7903
Elapsed Time: 0.0006 seconds
Hashing Power: 58164 hashes per second

[...]

Difficulty: 4194304 (22 bits)
Starting search...
Success with nonce 1759164
Hash is 0000008bb8f0e731f0496b8e530da984e85fb3cd2bd81882fe8ba3610b6cefc3
Elapsed Time: 13.3201 seconds
Hashing Power: 132068 hashes per second
Difficulty: 8388608 (23 bits)
Starting search...
Success with nonce 14214729
Hash is 000001408cf12dbd20fcba6372a223e098d58786c6ff93488a9f74f5df4df0a3
Elapsed Time: 110.1507 seconds
Hashing Power: 129048 hashes per second
Difficulty: 16777216 (24 bits)
Starting search...
Success with nonce 24586379
Hash is 0000002c3d6b370fccd699708d1b7cb4a94388595171366b944d68b2acce8b95
Elapsed Time: 195.2991 seconds
Hashing Power: 125890 hashes per second

[...]

Difficulty: 67108864 (26 bits)
Starting search...
Success with nonce 84561291
Hash is 0000001f0ea21e676b6dde5ad429b9d131a9f2b000802ab2f169cbca22b1e21a
Elapsed Time: 665.0949 seconds
Hashing Power: 127141 hashes per second</pre>
</div>
</div>
</div>
</div>
<div>
<p>As you can see, increasing the difficulty by 1 bit causes a doubling in the time it takes to find a solution. If you think of the entire 256-bit number space, each time you constrain one more bit to zero, you decrease the search space by half. In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#pow_example_outputs">Running the Proof-of-Work example for various difficulties</a>, it takes 84 million hash attempts to find a nonce that produces a hash with 26 leading bits as zero. Even at a speed of more than 120,000 hashes per second, it still requires 10 minutes on a laptop to find this solution.</p>
</div>
<div>
<p>At the time of writing, the network is attempting to find a block whose header hash is less than:</p>
</div>
<div>
<div>
<pre>0000000000000000029AB9000000000000000000000000000000000000000000</pre>
</div>
</div>
<div>
<p>As you can see, there are a lot of zeros at the beginning of that target, meaning that the acceptable range of hashes is much smaller, hence itâs more difficult to find a valid hash. It will take on average more than 1.8 zeta-hashes (thousand billion billion hashes) per second for the network to discover the next block. That seems like an impossible task, but fortunately the network is bringing 3 exa-hashes per second (EH/sec) of processing power to bear, which will be able to find a block in about 10 minutes on average.</p>
</div>
</div>
<div>
<h4 id="user-content-target_bits"><a id="user-content-target-representation" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#target-representation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Target Representation</h4>
<div>
<p>In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#block277316">Using the command line to retrieve block 277,316</a>, we saw that the block contains the target, in a notation called "target bits" or just "bits," which in block 277,316 has the value of 0x1903a30c. This notation expresses the Proof-of-Work target as a coefficient/exponent format, with the first two hexadecimal digits for the exponent and the next six hex digits as the coefficient. In this block, therefore, the exponent is 0x19 and the coefficient is 0x03a30c.</p>
</div>
<div>
<p>The formula to calculate the difficulty target from this representation is:</p>
</div>
<ul>
  <li>target = coefficient * 2<sup>(8*(exponentâ3))</sup></li>
</ul>
<div>
<p>Using that formula, and the difficulty bits value 0x1903a30c, we get:</p>
</div>
<ul>
  <li>target = 0x03a30c * 2<sup>0x08*(0x19-0x03)</sup></li>
  <li>=&gt; target = 0x03a30c * 2<sup>(0x08*0x16)</sup></li>
  <li>=&gt; target = 0x03a30c * 2<sup>0xB0</sup></li>
</ul>
<div>
<p>which in decimal is:</p>
</div>
<ul>
  <li>=&gt; target = 238,348 * 2<sup>176</sup></li>
  <li>=&gt; target = <br>22,829,202,948,393,929,850,749,706,076,701,368,331,072,452,018,388,575,715,328</li>
</ul>
<div>
<p>switching back to hexadecimal:</p>
</div>
<ul>
  <li>=&gt; target = <br>0x0000000000000003A30C00000000000000000000000000000000000000000000</li>
</ul>
<div>
<p>This means that a valid block for height 277,316 is one that has a block header hash that is less than the target. In binary that number must have more than 60 leading bits set to zero. With this level of difficulty, a single miner processing 1 trillion hashes per second (1 terahash per second or 1 TH/sec) would only find a solution once every 8,496 blocks or once every 59 days, on average.</p>
</div>
</div>
<div>
<h4 id="user-content-target"><a id="user-content-retargeting-to-adjust-difficulty" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#retargeting-to-adjust-difficulty"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Retargeting to Adjust Difficulty</h4>
<div>
<p>As we saw, the target determines the difficulty and therefore affects how long it takes to find a solution to the Proof-of-Work algorithm. This leads to the obvious questions: Why is the difficulty adjustable, who adjusts it, and how?</p>
</div>
<div>
<p>Bitcoinâs blocks are generated every 10 minutes, on average. This is bitcoinâs heartbeat and underpins the frequency of currency issuance and the speed of transaction settlement. It has to remain constant not just over the short term, but over a period of many decades. Over this time, it is expected that computer power will continue to increase at a rapid pace. Furthermore, the number of participants in mining and the computers they use will also constantly change. To keep the block generation time at 10 minutes, the difficulty of mining must be adjusted to account for these changes. In fact, the Proof-of-Work target is a dynamic parameter that is periodically adjusted to meet a 10-minute block interval goal. In simple terms, the target is set so that the current mining power will result in a 10-minute block interval.</p>
</div>
<div>
<p>How, then, is such an adjustment made in a completely decentralized network? Retargeting occurs automatically and on every node independently. Every 2,016 blocks, all nodes retarget the Proof-of-Work. The equation for retargeting measures the time it took to find the last 2,016 blocks and compares that to the expected time of 20,160 minutes (2,016 blocks times the desired 10-minute block interval). The ratio between the actual timespan and desired timespan is calculated and a proportionate adjustment (up or down) is made to the target. In simple terms: If the network is finding blocks faster than every 10 minutes, the difficulty increases (target decreases). If block discovery is slower than expected, the difficulty decreases (target increases).</p>
</div>
<div>
<p>The equation can be summarized as:</p>
</div>
<div>
<div>
<pre>New Target = Old Target * (Actual Time of Last 2016 Blocks / 20160 minutes)</pre>
</div>
</div>
<div>
<p><a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#retarget_code">Retargeting the Proof-of-WorkâCalculateNextWorkRequired() in pow.cpp</a> shows the code used in the Bitcoin Core client.</p>
</div>
<div id="user-content-retarget_code">
<div>Example 13. Retargeting the Proof-of-WorkâCalculateNextWorkRequired() in pow.cpp</div>
<div>
<div>
<div>
<div class="highlight highlight-source-c++"><pre>   <span class="pl-c"><span class="pl-c">//</span> Limit adjustment step</span>
    <span class="pl-c1">int64_t</span> nActualTimespan = pindexLast-&gt;<span class="pl-en">GetBlockTime</span>() - nFirstBlockTime;
    <span class="pl-en">LogPrintf</span>(<span class="pl-s"><span class="pl-pds">"</span>  nActualTimespan = %d  before bounds<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>, nActualTimespan);
    <span class="pl-k">if</span> (nActualTimespan &lt; params.nPowTargetTimespan/<span class="pl-c1">4</span>)
        nActualTimespan = params.nPowTargetTimespan/<span class="pl-c1">4</span>;
    <span class="pl-k">if</span> (nActualTimespan &gt; params.nPowTargetTimespan*<span class="pl-c1">4</span>)
        nActualTimespan = params.nPowTargetTimespan*<span class="pl-c1">4</span>;

    <span class="pl-c"><span class="pl-c">//</span> Retarget</span>
    <span class="pl-k">const</span> arith_uint256 bnPowLimit = UintToArith256(params.powLimit);
    arith_uint256 bnNew;
    arith_uint256 bnOld;
    bnNew.SetCompact(pindexLast-&gt;nBits);
    bnOld = bnNew;
    bnNew *= nActualTimespan;
    bnNew /= params.nPowTargetTimespan;

    <span class="pl-k">if</span> (bnNew &gt; bnPowLimit)
        bnNew = bnPowLimit;</pre></div>
</div>
</div>
</div>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Note</div>
</td>
<td>
<div>
<p>While the target calibration happens every 2,016 blocks, because of an off-by-one error in the original Bitcoin Core client it is based on the total time of the previous 2,015 blocks (not 2,016 as it should be), resulting in a retargeting bias toward higher difficulty by 0.05%.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>The parameters Interval (2,016 blocks) and TargetTimespan (two weeks as 1,209,600 seconds) are defined in <em>chainparams.cpp</em>.</p>
</div>
<div>
<p>To avoid extreme volatility in the difficulty, the retargeting adjustment must be less than a factor of four (4) per cycle. If the required target adjustment is greater than a factor of four, it will be adjusted by a factor of 4 and not more. Any further adjustment will be accomplished in the next retargeting period because the imbalance will persist through the next 2,016 blocks. Therefore, large discrepancies between hashing power and difficulty might take several 2,016 block cycles to balance out.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>The difficulty of mining a bitcoin block is approximately '10 minutes of processing' for the entire network, based on the time it took to mine the previous 2,016 blocks, adjusted every 2,016 blocks. This is achieved by lowering or raising the target.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>Note that the target is independent of the number of transactions or the value of transactions. This means that the amount of hashing power and therefore electricity expended to secure bitcoin is also entirely independent of the number of transactions. Bitcoin can scale up, achieve broader adoption, and remain secure without any increase in hashing power from todayâs level. The increase in hashing power represents market forces as new miners enter the market to compete for the reward. As long as enough hashing power is under the control of miners acting honestly in pursuit of the reward, it is enough to prevent "takeover" attacks and, therefore, it is enough to secure bitcoin.</p>
</div>
<div>
<p>The difficulty of mining is closely related to the cost of electricity and the exchange rate of bitcoin vis-a-vis the currency used to pay for electricity. High-performance mining systems are about as efficient as possible with the current generation of silicon fabrication, converting electricity into hashing computation at the highest rate possible. The primary influence on the mining market is the price of one kilowatt-hour of electricity in bitcoin, because that determines the profitability of mining and therefore the incentives to enter or exit the mining market.</p>
</div>
</div>
</div>
<div>
<h3 id="user-content-successfully-mining-the-block"><a id="user-content-successfully-mining-the-block" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#successfully-mining-the-block"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Successfully Mining the Block</h3>
<div>
<p>As we saw earlier, Jingâs node has constructed a candidate block and prepared it for mining. Jing has several hardware mining rigs with application-specific integrated circuits, where hundreds of thousands of integrated circuits run the SHA256 algorithm in parallel at incredible speeds. Many of these specialized machines are connected to his mining node over USB or a local area network. Next, the mining node running on Jingâs desktop transmits the block header to his mining hardware, which starts testing trillions of nonces per second. Because the nonce is only 32 bits, after exhausting all the nonce possibilities (about 4 billion), the mining hardware changes the block header (adjusting the coinbase extra nonce space or timestamp) and resets the nonce counter, testing new combinations.</p>
</div>
<div>
<p>Almost 11 minutes after starting to mine block 277,316, one of the hardware mining machines finds a solution and sends it back to the mining node.</p>
</div>
<div>
<p>When inserted into the block header, the nonce 924,591,752 produces a block hash of:</p>
</div>
<div>
<div>
<pre>0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4</pre>
</div>
</div>
<div>
<p>which is less than the target:</p>
</div>
<div>
<div>
<pre>0000000000000003A30C00000000000000000000000000000000000000000000</pre>
</div>
</div>
<div>
<p>Immediately, Jingâs mining node transmits the block to all its peers. They receive, validate, and then propagate the new block. As the block ripples out across the network, each node adds it to its own copy of the blockchain, extending it to a new height of 277,316 blocks. As mining nodes receive and validate the block, they abandon their efforts to find a block at the same height and immediately start computing the next block in the chain, using Jingâs block as the "parent." By building on top of Jingâs newly discovered block, the other miners are essentially "voting" with their mining power and endorsing Jingâs block and the chain it extends.</p>
</div>
<div>
<p>In the next section, weâll look at the process each node uses to validate a block and select the longest chain, creating the consensus that forms the decentralized blockchain.</p>
</div>
</div>
<div>
<h3 id="user-content-validating-a-new-block"><a id="user-content-validating-a-new-block" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#validating-a-new-block"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Validating a New Block</h3>
<div>
<p>The third step in bitcoinâs consensus mechanism is independent validation of each new block by every node on the network. As the newly solved block moves across the network, each node performs a series of tests to validate it before propagating it to its peers. This ensures that only valid blocks are propagated on the network. The independent validation also ensures that miners who act honestly get their blocks incorporated in the blockchain, thus earning the reward. Those miners who act dishonestly have their blocks rejected and not only lose the reward, but also waste the effort expended to find a Proof-of-Work solution, thus incurring the cost of electricity without compensation.</p>
</div>
<div>
<p>When a node receives a new block, it will validate the block by checking it against a long list of criteria that must all be met; otherwise, the block is rejected. These criteria can be seen in the Bitcoin Core client in the functions CheckBlock and CheckBlockHeader and include:</p>
</div>
<div>
<ul>
<li>
<p>The block data structure is syntactically valid</p>
</li>
<li>
<p>The block header hash is less than the target (enforces the Proof-of-Work)</p>
</li>
<li>
<p>The block timestamp is less than two hours in the future (allowing for time errors)</p>
</li>
<li>
<p>The block size is within acceptable limits</p>
</li>
<li>
<p>The first transaction (and only the first) is a coinbase transaction</p>
</li>
<li>
<p>All transactions within the block are valid using the transaction checklist discussed in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#tx_verification">Independent Verification of Transactions</a></p>
</li>
</ul>
</div>
<div>
<p>The independent validation of each new block by every node on the network ensures that the miners cannot cheat. In previous sections we saw how miners get to write a transaction that awards them the new bitcoin created within the block and claim the transaction fees. Why donât miners write themselves a transaction for a thousand bitcoin instead of the correct reward? Because every node validates blocks according to the same rules. An invalid coinbase transaction would make the entire block invalid, which would result in the block being rejected and, therefore, that transaction would never become part of the ledger. The miners have to construct a perfect block, based on the shared rules that all nodes follow, and mine it with a correct solution to the Proof-of-Work. To do so, they expend a lot of electricity in mining, and if they cheat, all the electricity and effort is wasted. This is why independent validation is a key component of decentralized consensus.</p>
</div>
</div>
<div>
<h3 id="user-content-assembling-and-selecting-chains-of-blocks"><a id="user-content-assembling-and-selecting-chains-of-blocks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#assembling-and-selecting-chains-of-blocks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Assembling and Selecting Chains of Blocks</h3>
<div>
<p>The final step in bitcoinâs decentralized consensus mechanism is the assembly of blocks into chains and the selection of the chain with the most Proof-of-Work. Once a node has validated a new block, it will then attempt to assemble a chain by connecting the block to the existing blockchain.</p>
</div>
<div>
<p>Nodes maintain three sets of blocks: those connected to the main blockchain, those that form branches off the main blockchain (secondary chains), and finally, blocks that do not have a known parent in the known chains (orphans). Invalid blocks are rejected as soon as any one of the validation criteria fails and are therefore not included in any chain.</p>
</div>
<div>
<p>The "main chain" at any time is whichever <em>valid</em> chain of blocks has the most cumulative Proof-of-Work associated with it. Under most circumstances this is also the chain with the most blocks in it, unless there are two equal-length chains and one has more Proof-of-Work. The main chain will also have branches with blocks that are "siblings" to the blocks on the main chain. These blocks are valid but not part of the main chain. They are kept for future reference, in case one of those chains is extended to exceed the main chain in work. In the next section (<a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#forks">Blockchain Forks</a>), we will see how secondary chains occur as a result of an almost simultaneous mining of blocks at the same height.</p>
</div>
<div>
<p>When a new block is received, a node will try to slot it into the existing blockchain. The node will look at the blockâs "previous block hash" field, which is the reference to the blockâs parent. Then, the node will attempt to find that parent in the existing blockchain. Most of the time, the parent will be the "tip" of the main chain, meaning this new block extends the main chain. For example, the new block 277,316 has a reference to the hash of its parent block 277,315. Most nodes that receive 277,316 will already have block 277,315 as the tip of their main chain and will therefore link the new block and extend that chain.</p>
</div>
<div>
<p>Sometimes, as we will see in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#forks">Blockchain Forks</a>, the new block extends a chain that is not the main chain. In that case, the node will attach the new block to the secondary chain it extends and then compare the work of the secondary chain to the main chain. If the secondary chain has more cumulative work than the main chain, the node will <em>reconverge</em> on the secondary chain, meaning it will select the secondary chain as its new main chain, making the old main chain a secondary chain. If the node is a miner, it will now construct a block extending this new, longer, chain.</p>
</div>
<div>
<p>If a valid block is received and no parent is found in the existing chains, that block is considered an "orphan." Orphan blocks are saved in the orphan block pool where they will stay until their parent is received. Once the parent is received and linked into the existing chains, the orphan can be pulled out of the orphan pool and linked to the parent, making it part of a chain. Orphan blocks usually occur when two blocks that were mined within a short time of each other are received in reverse order (child before parent).</p>
</div>
<div>
<p>By selecting the greatest-cumulative-work valid chain, all nodes eventually achieve network-wide consensus. Temporary discrepancies between chains are resolved eventually as more work is added, extending one of the possible chains. Mining nodes "vote" with their mining power by choosing which chain to extend by mining the next block. When they mine a new block and extend the chain, the new block itself represents their vote.</p>
</div>
<div>
<p>In the next section we will look at how discrepancies between competing chains (forks) are resolved by the independent selection of the greatest-cumulative-work chain.</p>
</div>
<div>
<h4 id="user-content-forks"><a id="user-content-blockchain-forks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#blockchain-forks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Blockchain Forks</h4>
<div>
<p>Because the blockchain is a decentralized data structure, different copies of it are not always consistent. Blocks might arrive at different nodes at different times, causing the nodes to have different perspectives of the blockchain. To resolve this, each node always selects and attempts to extend the chain of blocks that represents the most Proof-of-Work, also known as the longest chain or greatest cumulative work chain. By summing the work recorded in each block in a chain, a node can calculate the total amount of work that has been expended to create that chain. As long as all nodes select the greatest-cumulative-work chain, the global bitcoin network eventually converges to a consistent state. Forks occur as temporary inconsistencies between versions of the blockchain, which are resolved by eventual reconvergence as more blocks are added to one of the forks.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Tip</div>
</td>
<td>
<div>
<p>The blockchain forks described in this section occur naturally as a result of transmission delays in the global network. We will also look at deliberately induced forks later in this chapter.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>In the next few diagrams, we follow the progress of a "fork" event across the network. The diagram is a simplified representation of the bitcoin network. For illustration purposes, different blocks are shown as different shapes (star, triangle, upside-down triangle, rhombus), spreading across the network. Each node in the network is represented as a circle.</p>
</div>
<div>
<p>Each node has its own perspective of the global blockchain. As each node receives blocks from its neighbors, it updates its own copy of the blockchain, selecting the greatest-cumulative-work chain. For illustration purposes, each node contains a shape that represents the block that it believes is currently the tip of the main chain. So, if you see a star shape in the node, that means that the star block is the tip of the main chain, as far as that node is concerned.</p>
</div>
<div>
<p>In the first diagram (<a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#fork1">Before the forkâall nodes have the same perspective</a>), the network has a unified perspective of the blockchain, with the star block as the tip of the main chain.</p>
</div>
<div id="user-content-fork1">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1002.png"><img src="./Mining_and_Consensus_files/mbc2_1002.png" alt="Before the fork - all nodes have the same perspective" style="max-width:100%;"></a>
</div>
<div>Figure 2. Before the forkâall nodes have the same perspective</div>
</div>
<div>
<p>A "fork" occurs whenever there are two candidate blocks competing to form the longest blockchain. This occurs under normal conditions whenever two miners solve the Proof-of-Work algorithm within a short period of time from each other. As both miners discover a solution for their respective candidate blocks, they immediately broadcast their own "winning" block to their immediate neighbors who begin propagating the block across the network. Each node that receives a valid block will incorporate it into its blockchain, extending the blockchain by one block. If that node later sees another candidate block extending the same parent, it connects the second candidate on a secondary chain. As a result, some nodes will "see" one candidate block first, while other nodes will see the other candidate block and two competing versions of the blockchain will emerge.</p>
</div>
<div>
<p>In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#fork2">Visualization of a blockchain fork event: two blocks found simultaneously</a>, we see two miners (Node X and Node Y) who mine two different blocks almost simultaneously. Both of these blocks are children of the star block, and extend the chain by building on top of the star block. To help us track it, one is visualized as a triangle block originating from Node X, and the other is shown as an upside-down triangle block originating from Node Y.</p>
</div>
<div id="user-content-fork2">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1003.png"><img src="./Mining_and_Consensus_files/mbc2_1003.png" alt="Visualization of a blockchain fork event: two blocks found simultaneously" style="max-width:100%;"></a>
</div>
<div>Figure 3. Visualization of a blockchain fork event: two blocks found simultaneously</div>
</div>
<div>
<p>Letâs assume, for example, that a miner Node X finds a Proof-of-Work solution for a block "triangle" that extends the blockchain, building on top of the parent block "star." Almost simultaneously, the miner Node Y who was also extending the chain from block "star" finds a solution for block "upside-down triangle," his candidate block. Now, there are two possible blocks; one we call "triangle," originating in Node X; and one we call "upside-down triangle," originating in Node Y. Both blocks are valid, both blocks contain a valid solution to the Proof-of-Work, and both blocks extend the same parent (block "star"). Both blocks likely contain most of the same transactions, with only perhaps a few differences in the order of transactions.</p>
</div>
<div>
<p>As the two blocks propagate, some nodes receive block "triangle" first and some receive block "upside-down triangle" first. As shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#fork3">Visualization of a blockchain fork event: two blocks propagate, splitting the network</a>, the network splits into two different perspectives of the blockchain; one side topped with a triangle block, the other with the upside-down-triangle block.</p>
</div>
<div id="user-content-fork3">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1004.png"><img src="./Mining_and_Consensus_files/mbc2_1004.png" alt="Visualization of a blockchain fork event: two blocks propagate, splitting the network" style="max-width:100%;"></a>
</div>
<div>Figure 4. Visualization of a blockchain fork event: two blocks propagate, splitting the network</div>
</div>
<div>
<p>In the diagram, a randomly chosen "Node X" received the triangle block first and extended the star chain with it. Node X selected the chain with "triangle" block as the main chain. Later, Node X also received the "upside-down triangle" block. Since it was received second, it is assumed to have "lost" the race. Yet, the "upside-down triangle" block is not discarded. It is linked to the "star" block parent and forms a secondary chain. While Node X assumes it has correctly selected the winning chain, it keeps the "losing" chain so that it has the information needed to reconverge if the "losing" chain ends up "winning."</p>
</div>
<div>
<p>On the other side of the network, Node Y constructs a blockchain based on its own perspective of the sequence of events. It received "upside-down triangle" first and elected that chain as the "winner." When it later received "triangle" block, it connected it to the "star" block parent as a secondary chain.</p>
</div>
<div>
<p>Neither side is "correct," or "incorrect." Both are valid perspectives of the blockchain. Only in hindsight will one prevail, based on how these two competing chains are extended by additional work.</p>
</div>
<div>
<p>Mining nodes whose perspective resembles Node X will immediately begin mining a candidate block that extends the chain with "triangle" as its tip. By linking "triangle" as the parent of their candidate block, they are voting with their hashing power. Their vote supports the chain that they have elected as the main chain.</p>
</div>
<div>
<p>Any mining node whose perspective resembles Node Y will start building a candidate node with "upside-down triangle" as its parent, extending the chain that they believe is the main chain. And so, the race begins again.</p>
</div>
<div>
<p>Forks are almost always resolved within one block. While part of the networkâs hashing power is dedicated to building on top of "triangle" as the parent, another part of the hashing power is focused on building on top of "upside-down triangle." Even if the hashing power is almost evenly split, it is likely that one set of miners will find a solution and propagate it before the other set of miners have found any solutions. Letâs say, for example, that the miners building on top of "triangle" find a new block "rhombus" that extends the chain (e.g., star-triangle-rhombus). They immediately propagate this new block and the entire network sees it as a valid solution as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#fork4">Visualization of a blockchain fork event: a new block extends one fork, reconverging the network</a>.</p>
</div>
<div>
<p>All nodes that had chosen "triangle" as the winner in the previous round will simply extend the chain one more block. The nodes that chose "upside-down triangle" as the winner, however, will now see two chains: star-triangle-rhombus and star-upside-down-triangle. The chain star-triangle-rhombus is now longer (more cumulative work) than the other chain. As a result, those nodes will set the chain star-triangle-rhombus as the main chain and change the star-upside-down-triangle chain to a secondary chain, as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#fork5">Visualization of a blockchain fork event: the network reconverges on a new longest chain</a>. This is a chain reconvergence, because those nodes are forced to revise their view of the blockchain to incorporate the new evidence of a longer chain. Any miners working on extending the chain star-upside-down-triangle will now stop that work because their candidate block is an "orphan," as its parent "upside-down-triangle" is no longer on the longest chain. The transactions within "upside-down-triangle" that are not within "triangle" are re-inserted in the mempool for inclusion in the next block to become a part of the main chain. The entire network reconverges on a single blockchain star-triangle-rhombus, with "rhombus" as the last block in the chain. All miners immediately start working on candidate blocks that reference "rhombus" as their parent to extend the star-triangle-rhombus chain.</p>
</div>
<div id="user-content-fork4">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1005.png"><img src="./Mining_and_Consensus_files/mbc2_1005.png" alt="Visualization of a blockchain fork event: a new block extends one fork" style="max-width:100%;"></a>
</div>
<div>Figure 5. Visualization of a blockchain fork event: a new block extends one fork, reconverging the network</div>
</div>
<div id="user-content-fork5">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1006.png"><img src="./Mining_and_Consensus_files/mbc2_1006.png" alt="Visualization of a blockchain fork event: the network reconverges on a new longest chain" style="max-width:100%;"></a>
</div>
<div>Figure 6. Visualization of a blockchain fork event: the network reconverges on a new longest chain</div>
</div>
<div>
<p>It is theoretically possible for a fork to extend to two blocks, if two blocks are found almost simultaneously by miners on opposite "sides" of a previous fork. However, the chance of that happening is very low. Whereas a one-block fork might occur every day, a two-block fork occurs at most once every few weeks.</p>
</div>
<div>
<p>Bitcoinâs block interval of 10 minutes is a design compromise between fast confirmation times (settlement of transactions) and the probability of a fork. A faster block time would make transactions clear faster but lead to more frequent blockchain forks, whereas a slower block time would decrease the number of forks but make settlement slower.</p>
</div>
</div>
</div>
<div>
<h3 id="user-content-mining-and-the-hashing-race"><a id="user-content-mining-and-the-hashing-race" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#mining-and-the-hashing-race"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mining and the Hashing Race</h3>
<div>
<p>Bitcoin mining is an extremely competitive industry. The hashing power has increased exponentially every year of bitcoinâs existence. Some years the growth has reflected a complete change of technology, such as in 2010 and 2011 when many miners switched from using CPU mining to GPU mining and field programmable gate array (FPGA) mining. In 2013 the introduction of ASIC mining lead to another giant leap in mining power, by placing the SHA256 function directly on silicon chips specialized for the purpose of mining. The first such chips could deliver more mining power in a single box than the entire bitcoin network in 2010.</p>
</div>
<div>
<p>The following list shows the total hashing power of the bitcoin network, over the first eight years of operation:</p>
</div>
<div>
<dl>
<dt>2009</dt>
<dd>
<p>0.5 MH/secâ8 MH/sec (16Ã growth)</p>
</dd>
<dt>2010</dt>
<dd>
<p>8 MH/secâ116 GH/sec (14,500Ã growth)</p>
</dd>
<dt>2011</dt>
<dd>
<p>116 GH/secâ9 TH/sec (78Ã growth)</p>
</dd>
<dt>2012</dt>
<dd>
<p>9 TH/secâ23 TH/sec (2.5Ã growth)</p>
</dd>
<dt>2013</dt>
<dd>
<p>23 TH/secâ10 PH/sec (450Ã growth)</p>
</dd>
<dt>2014</dt>
<dd>
<p>10 PH/secâ300 PH/sec (30Ã growth)</p>
</dd>
<dt>2015</dt>
<dd>
<p>300 PH/sec-800 PH/sec (2.66Ã growth)</p>
</dd>
<dt>2016</dt>
<dd>
<p>800 PH/sec-2.5 EH/sec (3.12Ã growth)</p>
</dd>
</dl>
</div>
<div>
<p>In the chart in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#network_hashing_power">Total hashing power, terahashes per second (TH/sec)</a>, we can see that bitcoin networkâs hashing power increased over the past two years. As you can see, the competition between miners and the growth of bitcoin has resulted in an exponential increase in the hashing power (total hashes per second across the network).</p>
</div>
<div id="user-content-network_hashing_power">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1007.png"><img src="./Mining_and_Consensus_files/mbc2_1007.png" alt="NetworkHashingRate" style="max-width:100%;"></a>
</div>
<div>Figure 7. Total hashing power, terahashes per second (TH/sec)</div>
</div>
<div>
<p>As the amount of hashing power applied to mining bitcoin has exploded, the difficulty has risen to match it. The difficulty metric in the chart shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#bitcoin_difficulty">Bitcoinâs mining difficulty metric</a> is measured as a ratio of current difficulty over minimum difficulty (the difficulty of the first block).</p>
</div>
<div id="user-content-bitcoin_difficulty">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1008.png"><img src="./Mining_and_Consensus_files/mbc2_1008.png" alt="BitcoinDifficulty" style="max-width:100%;"></a>
</div>
<div>Figure 8. Bitcoinâs mining difficulty metric</div>
</div>
<div>
<p>In the last two years, the ASIC mining chips have become increasingly denser, approaching the cutting edge of silicon fabrication with a feature size (resolution) of 16 nanometers (nm). Currently, ASIC manufacturers are aiming to overtake general-purpose CPU chip manufacturers, designing chips with a feature size of 14 nm, because the profitability of mining is driving this industry even faster than general computing. There are no more giant leaps left in bitcoin mining, because the industry has reached the forefront of Mooreâs Law, which stipulates that computing density will double approximately every 18 months. Still, the mining power of the network continues to advance at an exponential pace as the race for higher density chips is matched with a race for higher density data centers where thousands of these chips can be deployed. Itâs no longer about how much mining can be done with one chip, but how many chips can be squeezed into a building, while still dissipating the heat and providing adequate power.</p>
</div>
<div>
<h4 id="user-content-extra_nonce"><a id="user-content-the-extra-nonce-solution" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#the-extra-nonce-solution"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Extra Nonce Solution</h4>
<div>
<p>Since 2012, bitcoin mining has evolved to resolve a fundamental limitation in the structure of the block header. In the early days of bitcoin, a miner could find a block by iterating through the nonce until the resulting hash was below the target. As difficulty increased, miners often cycled through all 4 billion values of the nonce without finding a block. However, this was easily resolved by updating the block timestamp to account for the elapsed time. Because the timestamp is part of the header, the change would allow miners to iterate through the values of the nonce again with different results.  Once mining hardware exceeded 4 GH/sec, however, this approach became increasingly difficult because the nonce values were exhausted in less than a second. As ASIC mining equipment started pushing and then exceeding the TH/sec hash rate, the mining software needed more space for nonce values in order to find valid blocks. The timestamp could be stretched a bit, but moving it too far into the future would cause the block to become invalid. A new source of "change" was needed in the block header. The solution was to use the coinbase transaction as a source of extra nonce values. Because the coinbase script can store between 2 and 100 bytes of data, miners started using that space as extra nonce space, allowing them to explore a much larger range of block header values to find valid blocks. The coinbase transaction is included in the merkle tree, which means that any change in the coinbase script causes the merkle root to change. Eight bytes of extra nonce, plus the 4 bytes of "standard" nonce allow miners to explore a total 2<sup>96</sup> (8 followed by 28 zeros) possibilities <em>per second</em> without having to modify the timestamp. If, in the future, miners could run through all these possibilities, they could then modify the timestamp. There is also more space in the coinbase script for future expansion of the extra nonce space.</p>
</div>
</div>
<div>
<h4 id="user-content-mining_pools"><a id="user-content-mining-pools" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#mining-pools"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mining Pools</h4>
<div>
<p>In this highly competitive environment, individual miners working alone (also known as solo miners) donât stand a chance. The likelihood of them finding a block to offset their electricity and hardware costs is so low that it represents a gamble, like playing the lottery. Even the fastest consumer ASIC mining system cannot keep up with commercial systems that stack tens of thousands of these chips in giant warehouses near hydroelectric powerstations. Miners now collaborate to form mining pools, pooling their hashing power and sharing the reward among thousands of participants. By participating in a pool, miners get a smaller share of the overall reward, but typically get rewarded every day, reducing uncertainty.</p>
</div>
<div>
<p>Letâs look at a specific example. Assume a miner has purchased mining hardware with a combined hashing rate of 14,000 gigahashes per second (GH/s), or 14 TH/s. In 2017 this equipment costs approximately $2,500 USD. The hardware consumes 1375 watts (1.3 kW) of electricity when running, 33 kW-hours a day, at a cost of $1 to $2 per day at very low electricity rates. At current bitcoin difficulty, the miner will be able to solo mine a block approximately once every 4 years. How do we work out that probability? It is based on a network-wide hashing rate of 3 EH/sec (in 2017), and the minerâs rate of 14 TH/sec:</p>
</div>
<ul>
  <li>P = (14 * 10<sup>12</sup> / 3 * 10<sup>18</sup>) * 210240 = 0.98</li>
</ul>
<div>
<p>â¦âwhere 21240 is the number of blocks in four years. The miner has a 98% probability of finding a block over four years, based on the global hash rate at the beginning of the period.</p>
</div>
<div>
<p>If the miner does find a single block in that timeframe, the payout of 12.5 bitcoin, at approximately $1,000 per bitcoin, will result in a single payout of $12,500, which will produce a net profit of about $7,000. However, the chance of finding a block in a 4-year period depends on the minerâs luck. He might find two blocks in 4 years and make a very large profit. Or he might not find a block for 5 years and suffer a bigger financial loss. Even worse, the difficulty of the bitcoin Proof-of-Work algorithm is likely to go up significantly over that period, at the current rate of growth of hashing power, meaning the miner has, at most, one year to break even before the hardware is effectively obsolete and must be replaced by more powerful mining hardware. If this miner participates in a mining pool, instead of waiting for a once-in-four-years $12,500 windfall, he will be able to earn approximately $50 to $60 per week. The regular payouts from a mining pool will help him amortize the cost of hardware and electricity over time without taking an enormous risk. The hardware will still be obsolete in one or two years and the risk is still high, but the revenue is at least regular and reliable over that period. Financially this only makes sense at very low electricity cost (less than 1 cent per kW-hour) and only at very large scale.</p>
</div>
<div>
<p>Mining pools coordinate many hundreds or thousands of miners, over specialized pool-mining protocols. The individual miners configure their mining equipment to connect to a pool server, after creating an account with the pool. Their mining hardware remains connected to the pool server while mining, synchronizing their efforts with the other miners. Thus, the pool miners share the effort to mine a block and then share in the rewards.</p>
</div>
<div>
<p>Successful blocks pay the reward to a pool bitcoin address, rather than individual miners. The pool server will periodically make payments to the miners' bitcoin addresses, once their share of the rewards has reached a certain threshold. Typically, the pool server charges a percentage fee of the rewards for providing the pool-mining service.</p>
</div>
<div>
<p>Miners participating in a pool split the work of searching for a solution to a candidate block, earning "shares" for their mining contribution. The mining pool sets a higher target (lower difficulty) for earning a share, typically more than 1,000 times easier than the bitcoin networkâs target. When someone in the pool successfully mines a block, the reward is earned by the pool and then shared with all miners in proportion to the number of shares they contributed to the effort.</p>
</div>
<div>
<p>Pools are open to any miner, big or small, professional or amateur. A pool will therefore have some participants with a single small mining machine, and others with a garage full of high-end mining hardware. Some will be mining with a few tens of a kilowatt of electricity, others will be running a data center consuming a megawatt of power. How does a mining pool measure the individual contributions, so as to fairly distribute the rewards, without the possibility of cheating? The answer is to use bitcoinâs Proof-of-Work algorithm to measure each pool minerâs contribution, but set at a lower difficulty so that even the smallest pool miners win a share frequently enough to make it worthwhile to contribute to the pool. By setting a lower difficulty for earning shares, the pool measures the amount of work done by each miner. Each time a pool miner finds a block header hash that is less than the pool target, she proves she has done the hashing work to find that result. More importantly, the work to find shares contributes, in a statistically measurable way, to the overall effort to find a hash lower than the bitcoin networkâs target. Thousands of miners trying to find low-value hashes will eventually find one low enough to satisfy the bitcoin network target.</p>
</div>
<div>
<p>Letâs return to the analogy of a dice game. If the dice players are throwing dice with a goal of throwing less than four (the overall network difficulty), a pool would set an easier target, counting how many times the pool players managed to throw less than eight. When pool players throw less than eight (the pool share target), they earn shares, but they donât win the game because they donât achieve the game target (less than four). The pool players will achieve the easier pool target much more often, earning them shares very regularly, even when they donât achieve the harder target of winning the game. Every now and then, one of the pool players will throw a combined dice throw of less than four and the pool wins. Then, the earnings can be distributed to the pool players based on the shares they earned. Even though the target of eight-or-less wasnât winning, it was a fair way to measure dice throws for the players, and it occasionally produces a less-than-four throw.</p>
</div>
<div>
<p>Similarly, a mining pool will set a (higher and easier) pool target that will ensure that an individual pool miner can find block header hashes that are less than the pool target often, earning shares. Every now and then, one of these attempts will produce a block header hash that is less than the bitcoin network target, making it a valid block and the whole pool wins.</p>
</div>
<div>
<h5 id="user-content-managed-pools"><a id="user-content-managed-pools" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#managed-pools"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Managed pools</h5>
<div>
<p>Most mining pools are "managed," meaning that there is a company or individual running a pool server. The owner of the pool server is called the <em>pool operator</em>, and he charges pool miners a percentage fee of the earnings.</p>
</div>
<div>
<p>The pool server runs specialized software and a pool-mining protocol that coordinate the activities of the pool miners. The pool server is also connected to one or more full bitcoin nodes and has direct access to a full copy of the blockchain database. This allows the pool server to validate blocks and transactions on behalf of the pool miners, relieving them of the burden of running a full node. For pool miners, this is an important consideration, because a full node requires a dedicated computer with at least 100 to 150 GB of persistent storage (disk) and at least 2 to 4 GB of memory (RAM). Furthermore, the bitcoin software running on the full node needs to be monitored, maintained, and upgraded frequently. Any downtime caused by a lack of maintenance or lack of resources will hurt the minerâs profitability. For many miners, the ability to mine without running a full node is another big benefit of joining a managed pool.</p>
</div>
<div>
<p>Pool miners connect to the pool server using a mining protocol such as Stratum (STM) or GetBlockTemplate (GBT). An older standard called GetWork (GWK) has been mostly obsolete since late 2012, because it does not easily support mining at hash rates above 4 GH/s. Both the STM and GBT protocols create block <em>templates</em> that contain a template of a candidate block header. The pool server constructs a candidate block by aggregating transactions, adding a coinbase transaction (with extra nonce space), calculating the merkle root, and linking to the previous block hash. The header of the candidate block is then sent to each of the pool miners as a template. Each pool miner then mines using the block template, at a higher (easier) target than the bitcoin network target, and sends any successful results back to the pool server to earn shares.</p>
</div>
</div>
<div>
<h5 id="user-content-peer-to-peer-mining-pool-p2pool"><a id="user-content-peer-to-peer-mining-pool-p2pool" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#peer-to-peer-mining-pool-p2pool"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Peer-to-peer mining pool (P2Pool)</h5>
<div>
<p>Managed pools create the possibility of cheating by the pool operator, who might direct the pool effort to double-spend transactions or invalidate blocks (see <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#consensus_attacks">Consensus Attacks</a>). Furthermore, centralized pool servers represent a single-point-of-failure. If the pool server is down or is slowed by a denial-of-service attack, the pool miners cannot mine. In 2011, to resolve these issues of centralization, a new pool mining method was proposed and implemented: P2Pool, a peer-to-peer mining pool without a central operator.</p>
</div>
<div>
<p>P2Pool works by decentralizing the functions of the pool server, implementing a parallel blockchain-like system called a <em>share chain</em>. A share chain is a blockchain running at a lower difficulty than the bitcoin blockchain. The share chain allows pool miners to collaborate in a decentralized pool by mining shares on the share chain at a rate of one share block every 30 seconds. Each of the blocks on the share chain records a proportionate share reward for the pool miners who contribute work, carrying the shares forward from the previous share block. When one of the share blocks also achieves the bitcoin network target, it is propagated and included on the bitcoin blockchain, rewarding all the pool miners who contributed to all the shares that preceded the winning share block. Essentially, instead of a pool server keeping track of pool miner shares and rewards, the share chain allows all pool miners to keep track of all shares using a decentralized consensus mechanism like bitcoinâs blockchain consensus mechanism.</p>
</div>
<div>
<p>P2Pool mining is more complex than pool mining because it requires that the pool miners run a dedicated computer with enough disk space, memory, and internet bandwidth to support a full bitcoin node and the P2Pool node software. P2Pool miners connect their mining hardware to their local P2Pool node, which simulates the functions of a pool server by sending block templates to the mining hardware. On P2Pool, individual pool miners construct their own candidate blocks, aggregating transactions much like solo miners, but then mine collaboratively on the share chain. P2Pool is a hybrid approach that has the advantage of much more granular payouts than solo mining, but without giving too much control to a pool operator like managed pools.</p>
</div>
<div>
<p>Even though P2Pool reduces the concentration of power by mining pool operators, it is conceivably vulnerable to 51% attacks against the share chain itself. A much broader adoption of P2Pool does not solve the 51% attack problem for bitcoin itself. Rather, P2Pool makes bitcoin more robust overall, as part of a diversified mining ecosystem.</p>
</div>
</div>
</div>
</div>
<div>
<h3 id="user-content-consensus_attacks"><a id="user-content-consensus-attacks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#consensus-attacks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Consensus Attacks</h3>
<div>
<p>Bitcoinâs consensus mechanism is, at least theoretically, vulnerable to attack by miners (or pools) that attempt to use their hashing power to dishonest or destructive ends. As we saw, the consensus mechanism depends on having a majority of the miners acting honestly out of self-interest. However, if a miner or group of miners can achieve a significant share of the mining power, they can attack the consensus mechanism so as to disrupt the security and availability of the bitcoin network.</p>
</div>
<div>
<p>It is important to note that consensus attacks can only affect future consensus, or at best, the most recent past (tens of blocks). Bitcoinâs ledger becomes more and more immutable as time passes. While in theory, a fork can be achieved at any depth, in practice, the computing power needed to force a very deep fork is immense, making old blocks practically immutable. Consensus attacks also do not affect the security of the private keys and signing algorithm (ECDSA). A consensus attack cannot steal bitcoin, spend bitcoin without signatures, redirect bitcoin, or otherwise change past transactions or ownership records. Consensus attacks can only affect the most recent blocks and cause denial-of-service disruptions on the creation of future blocks.</p>
</div>
<div>
<p>One attack scenario against the consensus mechanism is called the "51% attack." In this scenario a group of miners, controlling a majority (51%) of the total networkâs hashing power, collude to attack bitcoin. With the ability to mine the majority of the blocks, the attacking miners can cause deliberate "forks" in the blockchain and double-spend transactions or execute denial-of-service attacks against specific transactions or addresses. A fork/double-spend attack is where the attacker causes previously confirmed blocks to be invalidated by forking below them and re-converging on an alternate chain. With sufficient power, an attacker can invalidate six or more blocks in a row, causing transactions that were considered immutable (six confirmations) to be invalidated. Note that a double-spend can only be done on the attackerâs own transactions, for which the attacker can produce a valid signature. Double-spending oneâs own transactions is profitable if by invalidating a transaction the attacker can get an irreversible exchange payment or product without paying for it.</p>
</div>
<div>
<p>Letâs examine a practical example of a 51% attack. In the first chapter, we looked at a transaction between Alice and Bob for a cup of coffee. Bob, the cafe owner, is willing to accept payment for cups of coffee without waiting for confirmation (mining in a block), because the risk of a double-spend on a cup of coffee is low in comparison to the convenience of rapid customer service. This is similar to the practice of coffee shops that accept credit card payments without a signature for amounts below $25, because the risk of a credit-card chargeback is low while the cost of delaying the transaction to obtain a signature is comparatively larger. In contrast, selling a more expensive item for bitcoin runs the risk of a double-spend attack, where the buyer broadcasts a competing transaction that spends the same inputs (UTXO) and cancels the payment to the merchant. A double-spend attack can happen in two ways: either before a transaction is confirmed, or if the attacker takes advantage of a blockchain fork to undo several blocks. A 51% attack allows attackers to double-spend their own transactions in the new chain, thus undoing the corresponding transaction in the old chain.</p>
</div>
<div>
<p>In our example, malicious attacker Mallory goes to Carolâs gallery and purchases a beautiful triptych painting depicting Satoshi Nakamoto as Prometheus. Carol sells "The Great Fire" paintings for $250,000 in bitcoin to Mallory. Instead of waiting for six or more confirmations on the transaction, Carol wraps and hands the paintings to Mallory after only one confirmation. Mallory works with an accomplice, Paul, who operates a large mining pool, and the accomplice launches a 51% attack as soon as Malloryâs transaction is included in a block. Paul directs the mining pool to remine the same block height as the block containing Malloryâs transaction, replacing Malloryâs payment to Carol with a transaction that double-spends the same input as Malloryâs payment. The double-spend transaction consumes the same UTXO and pays it back to Malloryâs wallet, instead of paying it to Carol, essentially allowing Mallory to keep the bitcoin. Paul then directs the mining pool to mine an additional block, so as to make the chain containing the double-spend transaction longer than the original chain (causing a fork below the block containing Malloryâs transaction). When the blockchain fork resolves in favor of the new (longer) chain, the double-spent transaction replaces the original payment to Carol. Carol is now missing the three paintings and also has no bitcoin payment. Throughout all this activity, Paulâs mining pool participants might remain blissfully unaware of the double-spend attempt, because they mine with automated miners and cannot monitor every transaction or block.</p>
</div>
<div>
<p>To protect against this kind of attack, a merchant selling large-value items must wait at least six confirmations before giving the product to the buyer. Alternatively, the merchant should use an escrow multisignature account, again waiting for several confirmations after the escrow account is funded. The more confirmations elapse, the harder it becomes to invalidate a transaction with a 51% attack. For high-value items, payment by bitcoin will still be convenient and efficient even if the buyer has to wait 24 hours for delivery, which would correspond to approximately 144 confirmations.</p>
</div>
<div>
<p>In addition to a double-spend attack, the other scenario for a consensus attack is to deny service to specific bitcoin participants (specific bitcoin addresses). An attacker with a majority of the mining power can simply ignore specific transactions. If they are included in a block mined by another miner, the attacker can deliberately fork and remine that block, again excluding the specific transactions. This type of attack can result in a sustained denial-of-service against a specific address or set of addresses for as long as the attacker controls the majority of the mining power.</p>
</div>
<div>
<p>Despite its name, the 51% attack scenario doesnât actually require 51% of the hashing power. In fact, such an attack can be attempted with a smaller percentage of the hashing power. The 51% threshold is simply the level at which such an attack is almost guaranteed to succeed. A consensus attack is essentially a tug-of-war for the next block and the "stronger" group is more likely to win. With less hashing power, the probability of success is reduced, because other miners control the generation of some blocks with their "honest" mining power. One way to look at it is that the more hashing power an attacker has, the longer the fork he can deliberately create, the more blocks in the recent past he can invalidate, or the more blocks in the future he can control. Security research groups have used statistical modeling to claim that various types of consensus attacks are possible with as little as 30% of the hashing power.</p>
</div>
<div>
<p>The massive increase of total hashing power has arguably made bitcoin impervious to attacks by a single miner. There is no possible way for a solo miner to control more than a small percentage of the total mining power. However, the centralization of control caused by mining pools has introduced the risk of for-profit attacks by a mining pool operator. The pool operator in a managed pool controls the construction of candidate blocks and also controls which transactions are included. This gives the pool operator the power to exclude transactions or introduce double-spend transactions. If such abuse of power is done in a limited and subtle way, a pool operator could conceivably profit from a consensus attack without being noticed.</p>
</div>
<div>
<p>Not all attackers will be motivated by profit, however. One potential attack scenario is where an attacker intends to disrupt the bitcoin network without the possibility of profiting from such disruption. A malicious attack aimed at crippling bitcoin would require enormous investment and covert planning, but could conceivably be launched by a well-funded, most likely state-sponsored, attacker. Alternatively, a well-funded attacker could attack bitcoinâs consensus by simultaneously amassing mining hardware, compromising pool operators, and attacking other pools with denial-of-service. All of these scenarios are theoretically possible, but increasingly impractical as the bitcoin networkâs overall hashing power continues to grow exponentially.</p>
</div>
<div>
<p>Undoubtedly, a serious consensus attack would erode confidence in bitcoin in the short term, possibly causing a significant price decline. However, the bitcoin network and software are constantly evolving, so consensus attacks would be met with immediate countermeasures by the bitcoin community, making bitcoin more robust.</p>
</div>
</div>
<div>
<h3 id="user-content-consensus_changes"><a id="user-content-changing-the-consensus-rules" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#changing-the-consensus-rules"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Changing the Consensus Rules</h3>
<div>
<p>The rules of consensus determine the validity of transactions and blocks. These rules are the basis for collaboration between all bitcoin nodes and are responsible for the convergence of all local perspectives into a single consistent blockchain across the entire network.</p>
</div>
<div>
<p>While the consensus rules are invariable in the short term and must be consistent across all nodes, they are not invariable in the long term. In order to evolve and develop the bitcoin system, the rules have to change from time to time to accommodate new features, improvements, or bug fixes. Unlike traditional software development, however, upgrades to a consensus system are much more difficult and require coordination between all the participants.</p>
</div>
<div>
<h4 id="user-content-hard_forks"><a id="user-content-hard-forks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#hard-forks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hard Forks</h4>
<div>
<p>In <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#forks">Blockchain Forks</a> we looked at how the bitcoin network may briefly diverge, with two parts of the network following two different branches of the blockchain for a short time. We saw how this process occurs naturally, as part of the normal operation of the network and how the network reconverges on a common blockchain after one or more blocks are mined.</p>
</div>
<div>
<p>There is another scenario in which the network may diverge into following two chains: a change in the consensus rules. This type of fork is called a <em>hard fork</em>, because after the fork the network does not reconverge onto a single chain. Instead, the two chains evolve independently. Hard forks occur when part of the network is operating under a different set of consensus rules than the rest of the network. This may occur because of a bug or because of a deliberate change in the implementation of the consensus rules.</p>
</div>
<div>
<p>Hard forks can be used to change the rules of consensus, but they require coordination between all participants in the system. Any nodes that do not upgrade to the new consensus rules are unable to participate in the consensus mechanism and are forced onto a separate chain at the moment of the hard fork. Thus, a change introduced by a hard fork can be thought of as not "forward compatible," in that nonupgraded systems can no longer process the new consensus rules.</p>
</div>
<div>
<p>Letâs examine the mechanics of a hard fork with a specific example.</p>
</div>
<div>
<p><a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#blockchainwithforks">A blockchain with forks</a> shows a blockchain with two forks. At block height 4, a one-block fork occurs. This is the type of spontaneous fork we saw in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#forks">Blockchain Forks</a>. With the mining of block 5, the network reconverges on one chain and the fork is resolved.</p>
</div>
<div id="user-content-blockchainwithforks">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1009.png"><img src="./Mining_and_Consensus_files/mbc2_1009.png" alt="A blockchain with forks" style="max-width:100%;"></a>
</div>
<div>Figure 9. A blockchain with forks</div>
</div>
<div>
<p>Later, however, at block height 6, a hard fork occurs. Letâs assume that a new implementation of the client is released with a change in the consensus rules. Starting on block height 7, miners running this new implementation will accept a new type of digital signature, letâs call it a "Smores" signature, that is not ECDSA based. Immediately after, a node running the new implementation creates a transaction that contains a Smores signature and a miner with the updated software mines block 7b containing this transaction.</p>
</div>
<div>
<p>Any node or miner that has not upgraded the software to validate Smores signatures is now unable to process block 7b. From their perspective, both the transaction that contained a Smores signature and block 7b that contained that transaction are invalid, because they are evaluating them based upon the old consensus rules. These nodes will reject the transaction and the block and will not propagate them. Any miners that are using the old rules will not accept block 7b and will continue to mine a candidate block whose parent is block 6. In fact, miners using the old rules may not even receive block 7b if all the nodes they are connected to are also obeying the old rules and therefore not propagating the block. Eventually, they will be able to mine block 7a, which is valid under the old rules and does not contain any transactions with Smores signatures.</p>
</div>
<div>
<p>The two chains continue to diverge from this point. Miners on the "b" chain will continue to accept and mine transactions containing Smores signatures, while miners on the "a" chain will continue to ignore these transactions. Even if block 8b does not contain any Smores-signed transactions, the miners on the "a" chain cannot process it. To them it appears to be an orphan block, as its parent "7b" is not recognized as a valid block.</p>
</div>
</div>
<div>
<h4 id="user-content-hard-forks-software-network-mining-and-chain"><a id="user-content-hard-forks-software-network-mining-and-chain" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#hard-forks-software-network-mining-and-chain"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hard Forks: Software, Network, Mining, and Chain</h4>
<div>
<p>For software developers, the term "fork" has another meaning, adding confusion to the term "hard fork." In open source software, a fork occurs when a group of developers choose to follow a different software roadmap and start a competing implementation of an open source project. Weâve already discussed two circumstances that will lead to a hard fork: a bug in the consensus rules and a deliberate modification of the consensus rules. In the case of a deliberate change to the consensus rules, a software fork precedes the hard fork. However, for this type of hard fork to occur, a new software implementation of the consensus rules must be developed, adopted, and launched.</p>
</div>
<div>
<p>Examples of software forks that have attempted to change consensus rules include Bitcoin XT, Bitcoin Classic, and most recently Bitcoin Unlimited. However, none of these software forks have resulted in a hard fork. While a software fork is a necessary precondition, it is not in itself sufficient for a hard fork to occur. For a hard fork to occur, the competing implementation must be adopted and the new rules activated, by miners, wallets, and intermediary nodes. Conversely, there are numerous alternative implementations of Bitcoin Core, and even software forks, that do not change the consensus rules and barring a bug, can coexist on the network and interoperate without causing a hard fork.</p>
</div>
<div>
<p>Consensus rules may differ in obvious and explicit ways, in the validation of transactions or blocks. The rules may also differ in more subtle ways, in the implementation of the consensus rules as they apply to bitcoin scripts or cryptographic primitives such as digital signatures. Finally, the consensus rules may differ in unanticipated ways because of implicit consensus constraints imposed by system limitations or implementation details. An example of the latter was seen in the unanticipated hard fork during the upgrade of Bitcoin Core 0.7 to 0.8, which was caused by a limitation in the Berkeley DB implementation used to store blocks.</p>
</div>
<div>
<p>Conceptually, we can think of a hard fork as developing in four stages: a software fork, a network fork, a mining fork, and a chain fork.</p>
</div>
<div>
<p>The process begins when an alternative implementation of the client, with modified consensus rules, is created by developers.</p>
</div>
<div>
<p>When this forked implementation is deployed in the network, a certain percentage of miners, wallet users, and intermediate nodes may adopt and run this implementation. A resulting fork will depend upon whether the new consensus rules apply to blocks, transactions, or some other aspect of the system. If the new consensus rules pertain to transactions, then a wallet creating a transaction under the new rules may precipitate a network fork, followed by a hard fork when the transaction is mined into a block. If the new rules pertain to blocks, then the hard fork process will begin when a block is mined under the new rules.</p>
</div>
<div>
<p>First, the network will fork. Nodes based on the original implementation of the consensus rules will reject any transactions and blocks that are created under the new rules. Furthermore, the nodes following the original consensus rules will temporarily ban and disconnect from any nodes that are sending them these invalid transactions and blocks. As a result, the network will partition into two: old nodes will only remain connected to old nodes and new nodes will only be connected to new nodes. A single transaction or block based on the new rules will ripple through the network and result in the partition into two networks.</p>
</div>
<div>
<p>Once a miner using the new rules mines a block, the mining power and chain will also fork. New miners will mine on top of the new block, while old miners will mine a separate chain based on the old rules. The partitioned network will make it so that the miners operating on separate consensus rules wonât likely receive each otherâs blocks, as they are connected to two separate networks.</p>
</div>
</div>
<div>
<h4 id="user-content-diverging-miners-and-difficulty"><a id="user-content-diverging-miners-and-difficulty" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#diverging-miners-and-difficulty"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Diverging Miners and Difficulty</h4>
<div>
<p>As miners diverge into mining two different chains, the hashing power is split between the chains. The mining power can be split in any proportion between the two chains. The new rules may only be followed by a minority, or by the vast majority of the mining power.</p>
</div>
<div>
<p>Letâs assume, for example, an 80%â20% split, with the majority of the mining power using the new consensus rules. Letâs also assume that the fork occurs immediately after a retargeting period.</p>
</div>
<div>
<p>The two chains would each inherit the difficulty from the retargeting period. The new consensus rules would have 80% of the previously available mining power committed to them. From the perspective of this chain, the mining power has suddenly declined by 20% vis-a-vis the previous period. Blocks will be found on average every 12.5 minutes, representing the 20% decline in mining power available to extend this chain. This rate of block issuance will continue (barring any changes in hashing power) until 2016 blocks are mined, which will take approximately 25,200 minutes (at 12.5 minutes per block), or 17.5 days. After 17.5 days, a retarget will occur and the difficulty will adjust (reduced by 20%) to produce 10-minute blocks again, based on the reduced amount of hashing power in this chain.</p>
</div>
<div>
<p>The minority chain, mining under the old rules with only 20% of the hashing power, will face a much more difficult task. On this chain, blocks will now be mined every 50 minutes on average. The difficulty will not be adjusted for 2016 blocks, which will take 100,800 minutes, or approximately 10 weeks to mine. Assuming a fixed capacity per block, this will also result in a reduction of transaction capacity by a factor of 5, as there are fewer blocks per hour available to record transactions.</p>
</div>
</div>
<div>
<h4 id="user-content-contentious-hard-forks"><a id="user-content-contentious-hard-forks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#contentious-hard-forks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contentious Hard Forks</h4>
<div>
<p>This is the dawn of consensus software development. Just as open source development changed both the methods and products of software and created new methodologies, new tools, and new communities in its wake, consensus software development also represents a new frontier in computer science. Out of the debates, experiments, and tribulations of the bitcoin development roadmap, we will see new development tools, practices, methodologies, and communities emerge.</p>
</div>
<div>
<p>Hard forks are seen as risky because they force a minority to either upgrade or remain on a minority chain. The risk of splitting the entire system into two competing systems is seen by many as an unacceptable risk. As a result, many developers are reluctant to use the hard fork mechanism to implement upgrades to the consensus rules, unless there is near-unanimous support from the entire network. Any hard fork proposals that do not have near-unanimous support are considered too "contentious" to attempt without risking a partition of the system.</p>
</div>
<div>
<p>The issue of hard forks is highly controversial in the bitcoin development community, especially as it relates to any proposed changes to the consensus rules controlling the maximum block size limit. Some developers are opposed to any form of hard fork, seeing it as too risky. Others see the mechanism of hard fork as an essential tool for upgrading the consensus rules in a way that avoids "technical debt" and provides a clean break with the past. Finally, some developers see hard forks as a mechanism that should be used rarely, with a lot of advance planning and only under near-unanimous consensus.</p>
</div>
<div>
<p>Already we have seen the emergence of new methodologies to address the risks of hard forks. In the next section, we will look at soft forks, and the BIP-34 and BIP-9 methods for signaling and activation of consensus modifications.</p>
</div>
</div>
<div>
<h4 id="user-content-soft-forks"><a id="user-content-soft-forks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#soft-forks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Soft Forks</h4>
<div>
<p>Not all consensus rule changes cause a hard fork. Only consensus changes that are forward-incompatible cause a fork. If the change is implemented in such a way that an unmodified client still sees the transaction or block as valid under the previous rules, the change can happen without a fork.</p>
</div>
<div>
<p>The term <em>soft fork</em> was introduced to distinguish this upgrade method from a "hard fork." In practice, a soft fork is not a fork at all. A soft fork is a forward-compatible change to the consensus rules that allows unupgraded clients to continue to operate in consensus with the new rules.</p>
</div>
<div>
<p>One aspect of soft forks that is not immediately obvious is that soft fork upgrades can only be used to constrain the consensus rules, not to expand them. In order to be forward compatible, transactions and blocks created under the new rules must be valid under the old rules too, but not vice versa. The new rules can only limit what is valid; otherwise, they will trigger a hard fork when rejected under the old rules.</p>
</div>
<div>
<p>Soft forks can be implemented in a number of waysâthe term does not specify a particular method, rather a set of methods that all have one thing in common: they donât require all nodes to upgrade or force nonupgraded nodes out of consensus.</p>
</div>
<div>
<h5 id="user-content-soft-forks-redefining-nop-opcodes"><a id="user-content-soft-forks-redefining-nop-opcodes" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#soft-forks-redefining-nop-opcodes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Soft forks redefining NOP opcodes</h5>
<div>
<p>A number of soft forks have been implemented in bitcoin, based on the re-interpretation of NOP opcodes. Bitcoin Script had ten opcodes reserved for future use, NOP1 through NOP10. Under the consensus rules, the presence of these opcodes in a script is interpreted as a null-potent operator, meaning they have no effect. Execution continues after the NOP opcode as if it wasnât there.</p>
</div>
<div>
<p>A soft fork therefore can modify the semantics of a NOP code to give it new meaning. For example, BIP-65 (CHECKLOCKTIMEVERIFY) reinterpreted the NOP2 opcode. Clients implementing BIP-65 interpret NOP2 as OP_CHECKLOCKTIMEVERIFY and impose an absolute locktime consensus rule on UTXO that contain this opcode in their locking scripts. This change is a soft fork because a transaction that is valid under BIP-65 is also valid on any client that is not implementing (ignorant of) BIP-65. To the old clients, the script contains an NOP code, which is ignored.</p>
</div>
</div>
<div>
<h5 id="user-content-other-ways-to-soft-fork-upgrade"><a id="user-content-other-ways-to-soft-fork-upgrade" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#other-ways-to-soft-fork-upgrade"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Other ways to soft fork upgrade</h5>
<div>
<p>The reinterpretation of NOP opcodes was both planned for and an obvious mechanism for consensus upgrades. Recently, however, another soft fork mechanism was introduced that does not rely on NOP opcodes for a very specific type of consensus change. This is examined in more detail in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#segwit">[segwit]</a>. Segwit is an architectural change to the structure of a transaction, which moves the unlocking script (witness) from inside the transaction to an external data structure (segregating it). Segwit was initially envisioned as a hard fork upgrade, as it modified a fundamental structure (transaction). In November 2015, a developer working on Bitcoin Core proposed a mechanism by which segwit could be introduced as a soft fork. The mechanism used for this is a modification of the locking script of UTXO created under segwit rules, such that unmodified clients see the locking script as redeemable with any unlocking script whatsoever. As a result, segwit can be introduced without requiring every node to upgrade or split from the chain: a soft fork.</p>
</div>
<div>
<p>It is likely that there are other, yet to be discovered, mechanisms by which upgrades can be made in a forward-compatible way as a soft fork.</p>
</div>
</div>
</div>
<div>
<h4 id="user-content-criticisms-of-soft-forks"><a id="user-content-criticisms-of-soft-forks" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#criticisms-of-soft-forks"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Criticisms of Soft Forks</h4>
<div>
<p>Soft forks based on the NOP opcodes are relatively uncontroversial. The NOP opcodes were placed in Bitcoin Script with the explicit goal of allowing non-disruptive upgrades.</p>
</div>
<div>
<p>However, many developers are concerned that other methods of soft fork upgrades make unacceptable tradeoffs. Common criticisms of soft fork changes include:</p>
</div>
<div>
<dl>
<dt>Technical debt</dt>
<dd>
<p>Because soft forks are more technically complex than a hard fork upgrade, they introduce <em>technical debt</em>, a term that refers to increasing the future cost of code maintenance because of design tradeoffs made in the past. Code complexity in turn increases the likelihood of bugs and security vulnerabilities.</p>
</dd>
<dt>Validation relaxation</dt>
<dd>
<p>Unmodified clients see transactions as valid, without evaluating the modified consensus rules. In effect, the unmodified clients are not validating using the full range of consensus rules, as they are blind to the new rules. This applies to NOP-based upgrades, as well as other soft fork upgrades.</p>
</dd>
<dt>Irreversible upgrades</dt>
<dd>
<p>Because soft forks create transactions with additional consensus constraints, they become irreversible upgrades in practice. If a soft fork upgrade were to be reversed after beings activated, any transactions created under the new rules could result in a loss of funds under the old rules. For example, if a CLTV transaction is evaluated under the old rules, there is no timelock constraint and it can be spent at any time. Therefore, critics contend that a failed soft fork that had to be reversed because of a bug would almost certainly lead to loss of funds.</p>
</dd>
</dl>
</div>
</div>
</div>
<div>
<h3 id="user-content-softforksignaling"><a id="user-content-soft-fork-signaling-with-block-version" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#soft-fork-signaling-with-block-version"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Soft Fork Signaling with Block Version</h3>
<div>
<p>Since soft forks allow unmodified clients to continue to operate within consensus, the mechanism for "activating" a soft fork is through miners signaling readiness: a majority of miners must agree that they are ready and willing to enforce the new consensus rules. To coordinate their actions, there is a signaling mechanism that allows them to show their support for a consensus rule change. This mechanism was introduced with the activation of BIP-34 in March 2013 and replaced by the activation of BIP-9 in July 2016.</p>
</div>
<div>
<h4 id="user-content-bip-34-signaling-and-activation"><a id="user-content-bip-34-signaling-and-activation" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#bip-34-signaling-and-activation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>BIP-34 Signaling and Activation</h4>
<div>
<p>The first implementation, in BIP-34, used the block version field to allow miners to signal readiness for a specific consensus rule change. Prior to BIP-34, the block version was set to "1" by <em>convention</em> not enforced by <em>consensus</em>.</p>
</div>
<div>
<p>BIP-34 defined a consensus rule change that required the coinbase field (input) of the coinbase transaction to contain the block height. Prior to BIP-34, the coinbase could contain any arbitrary data the miners chose to include. After activation of BIP-34, valid blocks had to contain a specific block-height at the beginning of the coinbase and be identified with a version number greater than or equal to "2."</p>
</div>
<div>
<p>To signal the change and activation of BIP-34, miners set the block version to "2," instead of "1." This did not immediately make version "1" blocks invalid. Once activated, version "1" blocks would become invalid and all version "2" blocks would be required to contain the block height in the coinbase to be valid.</p>
</div>
<div>
<p>BIP-34 defined a two-step activation mechanism, based on a rolling window of 1000 blocks. A miner would signal his or her individual readiness for BIP-34 by constructing blocks with "2" as the version number. Strictly speaking, these blocks did not yet have to comply with the new consensus rule of including the block-height in the coinbase transaction because the consensus rule had not yet been activated. The consensus rules activated in two steps:</p>
</div>
<div>
<ul>
<li>
<p>If 75% (750 of the most recent 1000 blocks) are marked with version "2," then version "2" blocks must contain block height in the coinbase transaction or they are rejected as invalid. Version "1" blocks are still accepted by the network and do not need to contain block-height. The old and new consensus rules coexist during this period.</p>
</li>
<li>
<p>When 95% (950 of the most recent 1000 blocks) are version "2," version "1" blocks are no longer considered valid. Version "2" blocks are valid only if they contain the block-height in the coinbase (as per the previous threshold). Thereafter, all blocks must comply with the new consensus rules, and all valid blocks must contain block-height in the coinbase transaction.</p>
</li>
</ul>
</div>
<div>
<p>After successful signaling and activation under the BIP-34 rules, this mechanism was used twice more to activate soft forks:</p>
</div>
<div>
<ul>
<li>
<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0066.mediawiki">BIP-66</a> Strict DER Encoding of Signatures was activated by BIP-34 style signaling with a block version "3" and invalidating version "2" blocks.</p>
</li>
<li>
<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0065.mediawiki">BIP-65</a> CHECKLOCKTIMEVERIFY was activated by BIP-34 style signaling with a block version "4" and invalidating version "3" blocks.</p>
</li>
</ul>
</div>
<div>
<p>After the activation of BIP-65, the signaling and activation mechanism of BIP-34 was retired and replaced with the BIP-9 signaling mechanism described next.</p>
</div>
<div>
<p>The standard is defined in <a href="https://github.com/bitcoin/bips/blob/master/bip-0034.mediawiki">BIP-34 (Block v2, Height in Coinbase)</a>.</p>
</div>
</div>
<div>
<h4 id="user-content-bip-9-signaling-and-activation"><a id="user-content-bip-9-signaling-and-activation" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#bip-9-signaling-and-activation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>BIP-9 Signaling and Activation</h4>
<div>
<p>The mechanism used by BIP-34, BIP-66, and BIP-65 was successful in activating three soft forks. However, it was replaced because it had several limitations:</p>
</div>
<div>
<ul>
<li>
<p>By using the integer value of the block version, only one soft fork could be activated at a time, so it required coordination between soft fork proposals and agreement on their prioritization and sequencing.</p>
</li>
<li>
<p>Furthermore, because the block version was incremented, the mechanism didnât offer a straightforward way to reject a change and then propose a different one. If old clients were still running, they could mistake signaling for a new change as signaling for the previously rejected change.</p>
</li>
<li>
<p>Each new change irrevocably reduced the available block versions for future changes.</p>
</li>
</ul>
</div>
<div>
<p>BIP-9 was proposed to overcome these challenges and improve the rate and ease of implementing future changes.</p>
</div>
<div>
<p>BIP-9 interprets the block version as a bit field instead of an integer. Because the block version was originally used as an integer, versions 1 through 4, only 29 bits remain available to be used as a bit field. This leaves 29 bits that can be used to independently and simultaneously signal readiness on 29 different proposals.</p>
</div>
<div>
<p>BIP-9 also sets a maximum time for signaling and activation. This way miners donât need to signal forever. If a proposal is not activated within the TIMEOUT period (defined in the proposal), the proposal is considered rejected. The proposal may be resubmitted for signaling with a different bit, renewing the activation period.</p>
</div>
<div>
<p>Furthermore, after the TIMEOUT has passed and a feature has been activated or rejected, the signaling bit can be reused for another feature without confusion. Therefore, up to 29 changes can be signaled in parallel and after TIMEOUT the bits can be "recycled" to propose new changes.</p>
</div>
<div>
<table>
<tbody><tr>
<td>
<div>Note</div>
</td>
<td>
<div>
<p>While signaling bits can be reused or recycled, as long as the voting period does not overlap, the authors of BIP-9 recommend that bits are reused only when necessary; unexpected behavior could occur due to bugs in older software. In short, we should not expect to see reuse until all 29 bits have been used once.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
<div>
<p>Proposed changes are identified by a data structure that contains the following fields:</p>
</div>
<div>
<dl>
<dt>name</dt>
<dd>
<p>A short description used to distinguish between proposals. Most often the BIP describing the proposal, as "bipN," where N is the BIP number.</p>
</dd>
<dt>bit</dt>
<dd>
<p>0 through 28, the bit in the block version that miners use to signal approval for this proposal.</p>
</dd>
<dt>starttime</dt>
<dd>
<p>The time (based on Median Time Past, or MTP) that signaling starts after which the bitâs value is interpreted as signaling readiness for the proposal.</p>
</dd>
<dt>endtime</dt>
<dd>
<p>The time (based on MTP) after which the change is considered rejected if it has not reached the activation threshold.</p>
</dd>
</dl>
</div>
<div>
<p>Unlike BIP-34, BIP-9 counts activation signaling in whole intervals based on the difficulty retarget period of 2016 blocks. For every retarget period, if the sum of blocks signaling for a proposal exceeds 95% (1916 of 2016), the proposal will be activated one retarget period later.</p>
</div>
<div>
<p>BIP-9 offers a proposal state diagram to illustrate the various stages and transitions for a proposal, as shown in <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#bip9states">BIP-9 state transition diagram</a>.</p>
</div>
<div>
<p>Proposals start in the DEFINED state, once their parameters are known (defined) in the bitcoin software. For blocks with MTP after the start time, the proposal state transitions to STARTED. If the voting threshold is exceeded within a retarget period and the timeout has not been exceeded, the proposal state transitions to LOCKED_IN. One retarget period later, the proposal becomes ACTIVE. Proposals remain in the ACTIVE state perpetually once they reach that state. If the timeout elapses before the voting threshold has been reached, the proposal state changes to FAILED, indicating a rejected proposal. FAILED proposals remain in that state perpetually.</p>
</div>
<div id="user-content-bip9states">
<div>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/images/mbc2_1010.png"><img src="./Mining_and_Consensus_files/mbc2_1010.png" alt="BIP-9 Proposal State Transition Diagram" style="max-width:100%;"></a>
</div>
<div>Figure 10. BIP-9 state transition diagram</div>
</div>
<div>
<p>BIP-9 was first implemented for the activation of CHECKSEQUENCEVERIFY and associated BIPs (68, 112, 113). The proposal named "csv" was activated successfully in July of 2016.</p>
</div>
<div>
<p>The standard is defined in <a href="https://github.com/bitcoin/bips/blob/master/bip-0009.mediawiki">BIP-9 (Version bits with timeout and delay)</a>.</p>
</div>
</div>
</div>
<div>
<h3 id="user-content-consensus-software-development"><a id="user-content-consensus-software-development" class="anchor" aria-hidden="true" href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc#consensus-software-development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Consensus Software Development</h3>
<div>
<p>Consensus software continues to evolve and there is much discussion on the various mechanisms for changing the consensus rules. By its very nature, bitcoin sets a very high bar on coordination and consensus for changes. As a decentralized system, it has no "authority" that can impose its will on the participants of the network. Power is diffused between multiple constituencies such as miners, core developers, wallet developers, exchanges, merchants, and end users. Decisions cannot be made unilaterally by any of these constituencies. For example, while miners can theoretically change the rules by simple majority (51%), they are constrained by the consent of the other constituencies. If they act unilaterally, the rest of the participants may simply refuse to follow them, keeping the economic activity on a minority chain. Without economic activity (transactions, merchants, wallets, exchanges), the miners will be mining a worthless coin with empty blocks. This diffusion of power means that all the participants must coordinate, or no changes can be made. Status quo is the stable state of this system with only a few changes possible if there is strong consensus by a very large majority. The 95% threshold for soft forks is reflective of this reality.</p>
</div>
<div>
<p>It is important to recognize that there is no perfect solution for consensus development. Both hard forks and soft forks involve tradeoffs. For some types of changes, soft forks may be a better choice; for others, hard forks may be a better choice. There is no perfect choice; both carry risks. The one constant characteristic of consensus software development is that change is difficult and consensus forces compromise.</p>
</div>
<div>
<p>Some see this as a weakness of consensus systems. In time, you may come to see it as I do, as the systemâs greatest strength.</p>
</div>
</div>
</div>
</div></article>
  </div>

    </div>

  

  <details class="details-reset details-overlay details-overlay-dark">
    <summary data-hotkey="l" aria-label="Jump to line" role="button"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump" aria-label="Jump to line" role="dialog" aria-modal="true">
      <!-- '"` --><!-- </textarea></xmp> --><form class="js-jump-to-line-form Box-body d-flex" action="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="â">
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to lineâ¦" aria-label="Jump to line" autofocus="">
        <button type="submit" class="btn" data-close-dialog="">Go</button>
</form>    </details-dialog>
  </details>



  </div>
</div>

    </main>
  </div>
  

  </div>

        
<div class="footer container-lg width-full p-responsive" role="contentinfo">
  <div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      <li class="mr-3 mr-lg-0">Â© 2019 <span title="0.38199s from unicorn-7d9cd49f75-zxrxc">GitHub</span>, Inc.</li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to security, text:security" href="https://github.com/security">Security</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://githubstatus.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com/">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mx-lg-4" href="https://github.com/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.com/pricing" data-ga-click="Footer, go to Pricing, text:Pricing">Pricing</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://developer.github.com/" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://training.github.com/" data-ga-click="Footer, go to training, text:training">Training</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.blog/" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"></path></svg>
    </button>
    You canât perform that action at this time.
  </div>


    
    <script crossorigin="anonymous" integrity="sha512-2e003yIUkuCG1IeaeQwIgzMwqYiC+7wN/ouvY2yay84wnLng3/MScKxudf02uj4T4RZAnF5zJumvacsF9lfTMw==" type="application/javascript" src="./Mining_and_Consensus_files/frameworks-8e9b232b.js.download"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-5srqGco8avFoVw1A62FcGlaY8DzO3MWwwTL6l+CRizuO765zsFZkXamHphgnKHUzGbOOvr+NrqNS9CXYS1ySlQ==" type="application/javascript" src="./Mining_and_Consensus_files/github-bootstrap-75ce8f90.js.download"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner" hidden="">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="https://github.com/bitcoinbook/bitcoinbook/blob/develop/ch10.asciidoc">Reload</a> to refresh your session.</span>
  </div>
  <template id="site-details-dialog"></template>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

  <div aria-live="polite" class="js-global-screen-reader-notice sr-only"></div>

  


</body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>